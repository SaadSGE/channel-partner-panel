import{_ as G}from"./TablePagination-Cdr84kWy.js";import{_ as ne}from"./ShowMore-CAu1bglh.js";import{_ as J}from"./AppSelect-B5lFDM0q.js";import{_ as le}from"./AppTextField-DkyOzF4K.js";import{u as X,f as Y}from"./format-1xFb8tEb.js";import{u as ae}from"./applicationList-YGBSj49d.js";import"./commonFunction-DATGb0E7.js";import{u as re}from"./recordStore-CdVpcI_9.js";import{u as ie}from"./user-DmFB5KP3.js";import{f as ue,d as M}from"./helpers-BJL85UA9.js";import{_ as de}from"./AppDateTimePicker-Cz42LamZ.js";import{V as S}from"./VCardText-DwoObMNb.js";import{V as B,a as w}from"./VRow-XonbfKIj.js";import{V as pe}from"./VDivider-DFOEKbUK.js";import{V as Z}from"./VDataTableServer-CJnQL4vp.js";import{V as ce}from"./VChip-_ECrNTq0.js";import{V as x,a as _e,b as O,c as me}from"./VCard-Bua5yW2h.js";import{r as a,w as ge,H as ee,o as c,f as L,e as l,b as o,v as n,x as s,n as D,c as _,d as e,j as ve,k as fe,F as z,i as Q,a1 as K,a7 as ye,z as W}from"./main-JeqQMmwL.js";import he from"./index-WgX90BMT.js";import be from"./UserBioPanel-eBEjcWP0.js";import"./VPagination-x_yqUUV6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-CoN8BGU1.js";import"./VSelect-Bv_d0Orn.js";import"./VTextField-s0w8yvdP.js";/* empty css                   */import"./VCounter-C1ZtmHnM.js";import"./index-C7Z3FfHW.js";import"./index-AORGi_uA.js";import"./VField-Bv_JpsSw.js";import"./easing-CjukEv2V.js";import"./VInput-X8Rk_bMl.js";import"./forwardRefs-C-GTDzx5.js";import"./VList-BVi-OV8s.js";import"./ssrBoot-ClFHSiZX.js";import"./VAvatar-Tgh28dnY.js";import"./VImg-ObyGeY8j.js";import"./dialog-transition-C-2LiOZp.js";import"./VMenu-BI2dpZZA.js";import"./VOverlay-4C44LsMX.js";import"./lazy-DCvnru5p.js";import"./scopeId-D4-41dY0.js";import"./VCheckboxBtn-CXyd3DFt.js";import"./VSelectionControl-CEY3BFEN.js";import"./api-KOetWxHk.js";import"./index-B3bPRkoL.js";/* empty css              */import"./VDataTable-rWDDkoNw.js";import"./VTable-DV_Rb5f-.js";import"./filter-RS9YeugG.js";import"./VSlideGroup-DZZzcosZ.js";import"./AppCardActions-PeSRyoMU.js";import"./AppAutocomplete-DtgsWaYJ.js";import"./sweetalert2-z6gKu1nJ.js";import"./VSpacer-DdxwTxzT.js";import"./formatters-Bwi1Cc1X.js";import"./UserUpgradePlanDialog-CmLWhMak.js";import"./ConfirmDialog-pHkoiJFU.js";import"./VDialog-FsJLVASO.js";import"./DialogCloseBtn-CbYswSp3.js";import"./UserInfoEditDialog-CG-qxTkk.js";import"./VForm-C_9WjByA.js";import"./VSwitch-DNbWhbMU.js";const ke={key:0},Ue=e("strong",null,"Application ID:",-1),we=e("br",null,null,-1),Ae=e("strong",null,"Student Name:",-1),Ve=e("br",null,null,-1),Se=e("strong",null,"Student Email:",-1),xe=e("br",null,null,-1),Le=e("strong",null,"University:",-1),De=e("br",null,null,-1),Ce=e("strong",null,"Intake:",-1),Ie={key:1},Pe=e("strong",null,"Application ID:",-1),$e=e("br",null,null,-1),Te=e("strong",null,"Student Email:",-1),Ne=e("br",null,null,-1),qe=e("strong",null,"New Status:",-1),Be=e("br",null,null,-1),Ee=e("strong",null,"Old Status:",-1),Re=e("br",null,null,-1),je=e("strong",null,"Student Email:",-1),ze=e("br",null,null,-1),Fe=e("strong",null,"University:",-1),He=e("br",null,null,-1),Me=e("strong",null,"Intake:",-1),Oe=e("br",null,null,-1),Qe={key:2},Ke=e("strong",null,"Application ID:",-1),We=e("br",null,null,-1),Ge=e("strong",null,"Student Email:",-1),Je=e("br",null,null,-1),Xe=e("strong",null,"University:",-1),Ye=e("br",null,null,-1),Ze=e("strong",null,"Intake:",-1),et=e("br",null,null,-1),tt=e("strong",null,"Document Name:",-1),ot={key:3},st=e("strong",null,"Application ID:",-1),nt=e("br",null,null,-1),lt=e("strong",null,"Student Email:",-1),at=e("br",null,null,-1),rt=e("strong",null,"University:",-1),it=e("br",null,null,-1),ut=e("strong",null,"Intake:",-1),dt=e("br",null,null,-1),pt=e("strong",null,"Comment:",-1),ct={key:4},_t=e("strong",null,"Application ID:",-1),mt=e("br",null,null,-1),gt=e("strong",null,"Student Email:",-1),vt=e("br",null,null,-1),ft=e("strong",null,"University:",-1),yt=e("br",null,null,-1),ht=e("strong",null,"Intake:",-1),bt=e("br",null,null,-1),kt=e("strong",null,"Subject:",-1),Ut={key:5},wt=e("strong",null,"University Name:",-1),At=e("br",null,null,-1),Vt=e("strong",null,"Course Name:",-1),St=e("br",null,null,-1),xt=e("strong",null,"Intake:",-1),Lt={key:6},Dt=e("strong",null,"Error:",-1),Ct=e("br",null,null,-1),It=e("strong",null,"University Name:",-1),Pt=e("br",null,null,-1),$t=e("strong",null,"Course Name:",-1),Tt=e("br",null,null,-1),Nt=e("strong",null,"Intake:",-1),qt={key:7},Bt={__name:"UserActivityLog",props:{userId:{type:String,required:!0}},setup(F){const h=F,m=X(),C=a([]),g=a(!1),b=a(0),f=a(1),v=a(10),I=a(""),k=a(null),A=a(null),y=a(null),E=[{title:"Login",value:"login"},{title:"Logout",value:"logout"},{title:"Application Submit",value:"application_submit"},{title:"Application Update",value:"application_update"},{title:"Document Upload",value:"document_upload"}],P=[{title:"Date",key:"created_at",sortable:!0},{title:"Activity Type",key:"description",sortable:!0},{title:"Details",key:"details",sortable:!1},{title:"IP Address",key:"ip_address",sortable:!1}],V=async()=>{g.value=!0;try{m.setPage(f.value),m.setPerPage(v.value),m.setActivityType(k.value),m.setSearchQuery(I.value),m.setDateFrom(A.value),m.setDateTo(y.value);const u=await m.fetchUserActivityLogs(h.userId);C.value=u.data.data.map(r=>({...r,created_at:Y(new Date(r.created_at),"yyyy-MM-dd HH:mm:ss"),ip_address:r.properties.ip||"N/A",details:R(r)})),b.value=u.data.total}catch(u){console.error("Error fetching activity logs:",u)}finally{g.value=!1}},R=u=>{switch(u.description){case"login":return"User logged in";case"logout":return"User logged out";case"profile_update":return"Updated profile information";case"password_change":return"Changed password";case"application_submit":return`Submitted application #${u.properties.application_id}`;case"application_update":return`Updated application #${u.properties.application_id}`;case"document_upload":return`Uploaded document: ${u.properties.document_name||"Unknown"}`;case"comment_add":return`Added comment to application #${u.properties.application_id||"Unknown"}`;default:return u.description||"Performed an action"}},$=u=>{switch(u){case"login":return"success";case"logout":return"warning";case"application_submit":return"primary";case"application_status_update":return"info";case"document_upload":return"secondary";case"comment_added":return"success";case"university_communication_added":return"info";case"course_request_submitted":return"primary";case"course_request_failed":return"error";case"profile_update":return"secondary";case"password_change":return"warning";default:return"default"}},T=u=>{f.value=u.page,v.value=u.itemsPerPage,u.sortBy&&u.sortBy.length>0&&m.setSorting(u.sortBy[0].key,u.sortBy[0].order),V()};return ge([I,k,A,y],()=>{f.value=1,V()}),ee(()=>{V()}),(u,r)=>{const U=J,N=de,j=G;return c(),L(x,{title:"User Activity Log",class:"mt-5"},{default:l(()=>[o(S,null,{default:l(()=>[o(B,{class:"d-flex justify-end align-center"},{default:l(()=>[o(w,{cols:"12",sm:"6",md:"3"},{default:l(()=>[o(U,{modelValue:k.value,"onUpdate:modelValue":r[0]||(r[0]=t=>k.value=t),items:E,placeholder:"Select Activity Type",clearable:""},null,8,["modelValue"])]),_:1}),o(w,{cols:"12",sm:"6",md:"3"},{default:l(()=>[o(N,{modelValue:A.value,"onUpdate:modelValue":r[1]||(r[1]=t=>A.value=t),placeholder:"Select From Date"},null,8,["modelValue"])]),_:1}),o(w,{cols:"12",sm:"6",md:"3"},{default:l(()=>[o(N,{modelValue:y.value,"onUpdate:modelValue":r[2]||(r[2]=t=>y.value=t),placeholder:"Select To Date"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(pe),o(S,null,{default:l(()=>[o(B,{class:"d-flex justify-end align-center"},{default:l(()=>[o(w,{cols:"auto"},{default:l(()=>[o(U,{modelValue:v.value,"onUpdate:modelValue":[r[3]||(r[3]=t=>v.value=t),r[4]||(r[4]=t=>v.value=parseInt(t,10))],items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],label:"Items per page",style:{"inline-size":"8rem"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(Z,{"items-per-page":v.value,"onUpdate:itemsPerPage":r[6]||(r[6]=t=>v.value=t),page:f.value,"onUpdate:page":r[7]||(r[7]=t=>f.value=t),items:C.value,"items-length":b.value,headers:P,loading:g.value,class:"text-no-wrap","onUpdate:options":T},{"item.description":l(({item:t})=>[o(ce,{color:$(t.description),size:"small"},{default:l(()=>[n(s(D(ue)(t.description)),1)]),_:2},1032,["color"])]),"item.details":l(({item:t})=>[t.description==="application_submit"?(c(),_("div",ke,[Ue,n(" "+s(t.properties.application_id),1),we,Ae,n(" "+s(t.properties.student_name),1),Ve,Se,n(" "+s(t.properties.student_email),1),xe,Le,n(" "+s(t.properties.university_name),1),De,Ce,n(" "+s(t.properties.intake_name),1)])):t.description==="application_status_update"?(c(),_("div",Ie,[Pe,n(" "+s(t.properties.application_id),1),$e,Te,n(" "+s(t.properties.student_email),1),Ne,qe,n(" "+s(t.properties.new_status),1),Be,Ee,n(" "+s(t.properties.old_status),1),Re,je,n(" "+s(t.properties.student_email),1),ze,Fe,n(" "+s(t.properties.university_name),1),He,Me,n(" "+s(t.properties.intake_name),1),Oe])):t.description==="document_upload"?(c(),_("div",Qe,[Ke,n(" "+s(t.properties.application_id),1),We,Ge,n(" "+s(t.properties.student_email),1),Je,Xe,n(" "+s(t.properties.university_name),1),Ye,Ze,n(" "+s(t.properties.intake_name),1),et,tt,n(" "+s(t.properties.document_name),1)])):t.description==="comment_added"?(c(),_("div",ot,[st,n(" "+s(t.properties.application_id),1),nt,lt,n(" "+s(t.properties.student_email),1),at,rt,n(" "+s(t.properties.university_name),1),it,ut,n(" "+s(t.properties.intake_name),1),dt,pt,n(" "+s(t.properties.comment),1)])):t.description==="university_communication_added"?(c(),_("div",ct,[_t,n(" "+s(t.properties.application_id),1),mt,gt,n(" "+s(t.properties.student_email),1),vt,ft,n(" "+s(t.properties.university_name),1),yt,ht,n(" "+s(t.properties.intake_name),1),bt,kt,n(" "+s(t.properties.subject),1)])):t.description==="course_request_submitted"?(c(),_("div",Ut,[wt,n(" "+s(t.properties.university_name),1),At,Vt,n(" "+s(t.properties.course_name),1),St,xt,n(" "+s(t.properties.intake),1)])):t.description==="course_request_failed"?(c(),_("div",Lt,[Dt,n(" "+s(t.properties.error),1),Ct,It,n(" "+s(t.properties.university_name),1),Pt,$t,n(" "+s(t.properties.course_name),1),Tt,Nt,n(" "+s(t.properties.intake),1)])):(c(),_("div",qt,s(t.details),1))]),bottom:l(()=>[o(j,{page:f.value,"onUpdate:page":r[5]||(r[5]=t=>f.value=t),"items-per-page":v.value,"total-items":b.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","items","items-length","loading"])]),_:1})}}},Et={class:"d-flex align-center justify-space-between gap-x-2"},Rt={class:"text-h4 text-center"},jt=["href"],zt={class:"d-flex justify-space-between flex-wrap gap-6"},Ft={class:"d-flex flex-row gap-4 align-center flex-wrap"},es={__name:"[id]",setup(F){const h=ve();a(null),fe();const m=re();a();const C=ie();ae();const g=a([]),b=a(""),f=a(!1),v=X(),I=a([]),k=a(!1),A=a(0),y=a({page:1,itemsPerPage:10,sortBy:[{key:"created_at",order:"desc"}]});ee(async()=>{g.value=await C.fetchUser(h.params.id),$.value=g.value.documents||[],await P(),await j()});const E=d=>{const i=document.createElement("a");i.href=d,i.target="_blank",i.download="test",document.body.appendChild(i),i.click(),document.body.removeChild(i)},P=async(d=1)=>{const i=await m.fetchRecord(d,b.value,h.params.id);T.value=i.data,u.value=i.total},V=d=>d.replace(/_/g," ").replace(/\b\w/g,i=>i.toUpperCase()),R=[{title:"Country",key:"country.name"},{title:"Intake",key:"intake.name"},{title:"University",key:"university.name"},{title:"Course Type",key:"course.type"},{title:"Course Name",key:"course.name"},{title:"Tution Fee",key:"tuition_fee"},{title:"Course Duration",key:"course_duration"},{title:"Academic Requirement",key:"academic_requirement"},{title:"English Requirement",key:"english_requirement"},{title:"Actions",key:"actions",sortable:!1}],$=a([]);a(""),a(""),a(""),a("");const T=a(),u=a(),r=a(10),U=a(1),N=d=>{P(d.page)};a([]),a(0),a(),a();const j=async()=>{k.value=!0;try{const d=await v.fetchUserActivityLogs(h.params.id,y.value.page,y.value.itemsPerPage,y.value.sortBy[0]);I.value=d.data.data.map(i=>({...i,created_at:Y(new Date(i.created_at),"yyyy-MM-dd HH:mm:ss"),ip_address:i.properties.ip||"N/A",details:t(i)})),A.value=d.data.total}catch(d){console.error("Error fetching activity logs:",d)}finally{k.value=!1}},t=d=>{switch(d.description){case"login":return"User logged in";case"logout":return"User logged out";case"profile_update":return"Updated profile information";case"password_change":return"Changed password";case"application_submit":return`Submitted application #${d.properties.application_id}`;case"application_update":return`Updated application #${d.properties.application_id}`;case"document_upload":return`Uploaded document: ${d.properties.document_name||"Unknown"}`;case"comment_add":return`Added comment to application #${d.properties.application_id||"Unknown"}`;default:return d.description||"Performed an action"}};return(d,i)=>{const te=le,oe=J,H=ne,se=G;return c(),_(z,null,[o(B,null,{default:l(()=>[o(w,{cols:"12",md:"5",lg:"4"},{default:l(()=>[o(be,{"user-data":g.value},null,8,["user-data"])]),_:1}),o(w,{cols:"12",md:"4",sm:"6",lg:"8"},{default:l(()=>[o(B,null,{default:l(()=>[(c(!0),_(z,null,Q(g.value.dashboard,(p,q)=>(c(),L(w,{cols:"12",md:"5",lg:"4",key:q},{default:l(()=>[o(x,null,{default:l(()=>[o(_e,{class:"pb-3"},{default:l(()=>[o(O,null,{default:l(()=>[n(s(V(q)),1)]),_:2},1024),o(me,null,{default:l(()=>[n("Last Week")]),_:1})]),_:2},1024),o(S,null,{default:l(()=>[e("div",Et,[e("h4",Rt,s(p),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),D(M)(g.value.role,"channel partner")?(c(),L(x,{key:0,class:"mt-5"},{default:l(()=>[o(he,{userId:D(h).params.id},null,8,["userId"]),o(O,null,{default:l(()=>[n("Documents")]),_:1}),o(S,null,{default:l(()=>[(c(!0),_(z,null,Q($.value,(p,q)=>(c(),L(x,{key:q,class:"mb-2"},{default:l(()=>[o(S,{class:"d-flex justify-space-between align-center"},{default:l(()=>[e("div",null,[o(K,{size:"26",color:"red",icon:"tabler-file-type-doc"}),e("a",{href:p.document_path,target:"_blank"},s(V(p.document_type)),9,jt)]),o(ye,{icon:"",onClick:Ht=>E(p.document_path)},{default:l(()=>[o(K,{size:"24",icon:"tabler-eye"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):W("",!0),D(M)(g.value.role,"editor")?(c(),L(x,{key:1,title:"Course Details",class:"mt-2"},{default:l(()=>[o(S,null,{default:l(()=>[e("div",zt,[e("div",null,[o(te,{modelValue:b.value,"onUpdate:modelValue":i[0]||(i[0]=p=>b.value=p),style:{"max-inline-size":"200px","min-inline-size":"200px"},placeholder:"Search Record"},null,8,["modelValue"])]),e("div",Ft,[o(oe,{modelValue:r.value,"onUpdate:modelValue":i[1]||(i[1]=p=>r.value=p),items:[10,25,50,100],style:{"inline-size":"6.25rem"}},null,8,["modelValue"])])])]),_:1}),o(Z,{"items-per-page":r.value,"onUpdate:itemsPerPage":i[3]||(i[3]=p=>r.value=p),page:U.value,"onUpdate:page":i[4]||(i[4]=p=>U.value=p),loading:f.value,"items-length":u.value,headers:R,items:T.value,"item-value":"total",class:"text-no-wrap text-sm rounded-0","onUpdate:options":N},{"item.academic_requirement":l(({item:p})=>[o(H,{text:p.academic_requirement,lines:3},null,8,["text"])]),"item.english_requirement":l(({item:p})=>[o(H,{text:p.english_requirement,lines:3},null,8,["text"])]),bottom:l(()=>[o(se,{page:U.value,"onUpdate:page":i[2]||(i[2]=p=>U.value=p),"items-per-page":r.value,"total-items":u.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","loading","items-length","items"])]),_:1})):W("",!0),o(Bt,{userId:D(h).params.id},null,8,["userId"])],64)}}};export{es as default};
