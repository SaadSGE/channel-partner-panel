import{r as v,e as S}from"./validators-BFiGRe3y.js";import{r as V,j as B,k as F,a as R,o as T,c as D,b as e,e as t,d as l,n as a,I as g,x as k,v as u,a6 as M,a7 as j,F as N,ab as _,aB as A}from"./main-JeqQMmwL.js";import{_ as P}from"./AppTextField-DkyOzF4K.js";import{u as U}from"./auth-8KaQqrKD.js";import{u as h}from"./useGenerateImageVariant-D5sF6FPi.js";import{a as E,b as $,c as z,d as G}from"./auth-v2-login-illustration-light-CZAH_Qyi.js";import{l as K}from"./login-image-CycFNA80.js";import{a as O,b as W}from"./misc-mask-light-Ha4lQOdV.js";import{V as H}from"./VNodeRenderer-C1MApeP0.js";import{S as J}from"./sweetalert2-z6gKu1nJ.js";import{u as Q}from"./useAbility-CBvjhi1F.js";import{a as d,V as x}from"./VRow-XonbfKIj.js";import{V as X}from"./VImg-ObyGeY8j.js";import{V as Y}from"./VCard-Bua5yW2h.js";import{V as L}from"./VCardText-DwoObMNb.js";import{V as Z}from"./VForm-C_9WjByA.js";import{V as ee}from"./VCheckbox-DzrnpdNO.js";import"./helpers-BJL85UA9.js";import"./form-CoN8BGU1.js";import"./VTextField-s0w8yvdP.js";/* empty css                   */import"./VCounter-C1ZtmHnM.js";import"./index-C7Z3FfHW.js";import"./index-AORGi_uA.js";import"./VField-Bv_JpsSw.js";import"./easing-CjukEv2V.js";import"./VInput-X8Rk_bMl.js";import"./forwardRefs-C-GTDzx5.js";import"./api-KOetWxHk.js";import"./index-B3bPRkoL.js";/* empty css              */import"./VAvatar-Tgh28dnY.js";import"./VCheckboxBtn-CXyd3DFt.js";import"./VSelectionControl-CEY3BFEN.js";const ae={class:"auth-logo d-flex align-center gap-x-3"},te={class:"auth-title"},oe={class:"position-relative bg-background w-100 me-0"},re={class:"d-flex align-center justify-center w-100 h-100",style:{"padding-inline":"6.25rem"}},se={class:"text-h4 mb-1"},le={class:"text-capitalize"},ie=l("p",{class:"mb-0"}," Please sign-in to your account and start the adventure ",-1),ne={class:"d-flex align-center flex-wrap justify-space-between my-6"},me=l("span",null,"New on our platform?",-1),Ke={__name:"login",setup(ue){h(G,z,$,E,!0),h(W,O);const C=h(K),p=V(!1),b=V(),m=U(),c=B(),y=F(),I=Q(),n=V({email:"",password:""}),q=()=>{var s;(s=b.value)==null||s.validate().then(async({valid:r})=>{if(r)try{const i=await m.login(n.value.email,n.value.password),{accessToken:f,userData:o,abilities:w}=i;_("userAbilityRules").value=w,I.update(w),o.main_role=o.role,o.role="admin",_("userData").value=o,_("accessToken").value=f,await A(()=>{o.main_role=="editor"?y.replace(c.query.to?String(c.query.to):"/record"):y.replace(c.query.to?String(c.query.to):"/")})}catch(i){J.fire({icon:"error",title:"Login Failed",text:"Credential not match",confirmButtonText:"OK"}),console.error("Login error:",i)}})};return(s,r)=>{const i=R("RouterLink"),f=P;return T(),D(N,null,[e(i,{to:"/"},{default:t(()=>[l("div",ae,[e(a(H),{nodes:a(g).app.logo},null,8,["nodes"]),l("h1",te,k(a(g).app.title),1)])]),_:1}),e(x,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:t(()=>[e(d,{md:"8",class:"d-none d-md-flex"},{default:t(()=>[l("div",oe,[l("div",re,[e(X,{src:a(C),class:"auth-illustration mt-16 mb-2"},null,8,["src"])])])]),_:1}),e(d,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:t(()=>[e(Y,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:t(()=>[e(L,null,{default:t(()=>[l("h4",se,[u(" Welcome to "),l("span",le,k(a(g).app.title),1),u("!  ")]),ie]),_:1}),e(L,null,{default:t(()=>[e(a(Z),{ref_key:"refVForm",ref:b,onSubmit:M(q,["prevent"])},{default:t(()=>[e(x,null,{default:t(()=>[e(d,{cols:"12"},{default:t(()=>[e(f,{modelValue:a(n).email,"onUpdate:modelValue":r[0]||(r[0]=o=>a(n).email=o),label:"Email",placeholder:"johndoe@email.com",type:"email",autofocus:"",rules:["requiredValidator"in s?s.requiredValidator:a(v),"emailValidator"in s?s.emailValidator:a(S)],"error-messages":a(m).errors.email},null,8,["modelValue","rules","error-messages"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(f,{modelValue:a(n).password,"onUpdate:modelValue":r[1]||(r[1]=o=>a(n).password=o),label:"Password",placeholder:"路路路路路路路路路路路路",rules:["requiredValidator"in s?s.requiredValidator:a(v)],type:a(p)?"text":"password","error-messages":a(m).errors.password,"append-inner-icon":a(p)?"tabler-eye-off":"tabler-eye","onClick:appendInner":r[2]||(r[2]=o=>p.value=!a(p))},null,8,["modelValue","rules","type","error-messages","append-inner-icon"]),l("div",ne,[e(ee,{modelValue:a(m).rememberMe,"onUpdate:modelValue":r[3]||(r[3]=o=>a(m).rememberMe=o),label:"Remember Me"},null,8,["modelValue"]),e(i,{class:"text-primary",to:"/forgot-password"},{default:t(()=>[u(" Forgot Password? ")]),_:1})]),e(j,{block:"",type:"submit"},{default:t(()=>[u(" Login ")]),_:1})]),_:1}),e(d,{cols:"12",class:"text-center"},{default:t(()=>[me,e(i,{class:"text-primary ms-1",to:{name:"register"}},{default:t(()=>[u(" Create an account ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})],64)}}};export{Ke as default};
