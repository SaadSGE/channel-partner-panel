import{_ as te}from"./AppCardActions-BXF6kIhD.js";import{_ as ae}from"./TablePagination-D_DfYiMJ.js";import{_ as le}from"./AppTextField-DSJpg-NM.js";import{_ as oe}from"./AppSelect-CZN_1s3Q.js";import{_ as ie}from"./AppDateTimePicker-PMsO7XoA.js";import{_ as se}from"./AppAutocomplete-BNp56ce7.js";import{c as ne}from"./commonFunction-Cdif8_FG.js";import{u as re}from"./user-CkNTKEfH.js";import{g as M,r as q,a as me}from"./helpers-DF72T3lf.js";import{a as C,V as de}from"./VRow-DXbMUSlC.js";import{r as a,w as V,H as Y,o as D,c as G,b as o,e as s,f as N,z as $,F as ue,k as pe,a5 as ce,a as fe,v as E,d,x as S,n as R,y as ve,a1 as j}from"./main-CTbrSevp.js";import{u as z}from"./applicationList-Bn6wBzyy.js";import{S as F}from"./sweetalert2-z6gKu1nJ.js";import{u as _e}from"./useAbility-DfsnnlBb.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as H}from"./VCardText-B5fKlnga.js";import{V as he}from"./VSpacer-BNuSM6zL.js";import{V as ge}from"./VDataTableServer-DvvpGQ0D.js";import{V as Ae}from"./VChip-CPxWF4ht.js";import"./index-V586HTca.js";import"./VCard-Ci9imp9j.js";import"./VAvatar-DBW7-bfY.js";import"./VImg-B92ntwLo.js";import"./index-BRgyovDe.js";import"./VOverlay-B7R2_D3J.js";import"./easing-CjukEv2V.js";import"./lazy-DNzdQdOs.js";import"./scopeId-x2Y0lfX8.js";import"./VDivider-L9Mlvl37.js";import"./VPagination-DD-FVuJ8.js";import"./form-Ds3HToZK.js";import"./VTextField-ChiVERsS.js";/* empty css                   */import"./VCounter-Blvl4zX6.js";import"./VField-JRbYnBcN.js";import"./VInput-BqNPD8rp.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-C7h_PRZR.js";import"./VList-DvA9uE5Z.js";import"./ssrBoot-CcnxGcn-.js";import"./dialog-transition-DZuNSGQw.js";import"./VMenu-DN6OOuIy.js";import"./VCheckboxBtn-Cq39waP4.js";import"./VSelectionControl-xyKXg1p6.js";import"./filter-CmtLIoGQ.js";import"./api-CJk2VHiE.js";import"./index-Dz1rBMAR.js";/* empty css              */import"./VDataTable-D_YV_GL3.js";import"./VTable-DY1isjCm.js";import"./VSlideGroup-BsuK103q.js";const Se={__name:"Filters",props:{isAdmin:{type:Boolean,default:!1},selectedStatus:{type:Object,Required:!1},selectedChannelPartner:{type:Object,Required:!1},selectedUniversity:{type:Object,Required:!1},selectedApplicationOfficer:{type:Object,Required:!1},dateFrom:{type:Number,Required:!1},dateTo:{type:Number,Required:!1}},emits:["update-status","update-channel-partner","update-university","update-application-officer","update-date-from","update-date-to"],setup(T,{emit:B}){const I=a([{id:0,name:"Application Processing"},{id:1,name:"Application Submitted"},{id:2,name:"Pending Docs"},{id:3,name:"Offer Issue Conditional"},{id:4,name:"Offer Issue Unconditional"},{id:5,name:"Need Payment"},{id:6,name:"CAS Issued"},{id:7,name:"Additional Doc Needed"},{id:8,name:"Refund Required"},{id:9,name:"Application Rejected"},{id:10,name:"Session Expired"},{id:11,name:"Doc Received"},{id:12,name:"Partial Payment"}]),k=a([]),O=a([]),w=a([]),x=re(),f=ne(),v=a(M()==="admin"),p=T,c=B,_=a(p.selectedStatus),y=a(p.selectedChannelPartner),h=a(p.selectedUniversity),g=a(p.selectedApplicationOfficer),A=a(p.dateFrom),U=a(p.dateTo);V(_,i=>{c("update-status",i)}),V(y,i=>{c("update-channel-partner",i)}),V(h,i=>{c("update-university",i)}),V(g,i=>{c("update-application-officer",i)}),V(A,i=>{c("update-date-from",i)}),V(U,i=>{c("update-date-to",i)});const b=async()=>{try{const i=await f.getUniversities();k.value=i.data.map(r=>({id:r.id,name:r.name}));const n=await x.fetchUsers(1,"","channel partner","",!0);O.value=n.data.map(r=>({id:r.id,name:r.company_name_with_email}));const u=await x.fetchUsers(1,"","application control officer","",!0);w.value=u.data.map(r=>({id:r.id,name:r.name_with_email}))}catch(i){console.error("Error fetching filter options:",i)}};return Y(()=>{b()}),(i,n)=>{const u=se,r=ie;return D(),G(ue,null,[o(C,{cols:"12",md:"3"},{default:s(()=>[o(u,{modelValue:_.value,"onUpdate:modelValue":n[0]||(n[0]=t=>_.value=t),items:I.value,"item-title":t=>t.name,"item-value":t=>t.id,label:"Status",placeholder:"Select Status",clearable:""},null,8,["modelValue","items","item-title","item-value"])]),_:1}),v.value?(D(),N(C,{key:0,cols:"12",md:"3"},{default:s(()=>[o(u,{modelValue:y.value,"onUpdate:modelValue":n[1]||(n[1]=t=>y.value=t),items:O.value,"item-title":t=>t.name,"item-value":t=>t.id,label:"Channel Partner",placeholder:"Select Channel Partner",clearable:""},null,8,["modelValue","items","item-title","item-value"])]),_:1})):$("",!0),o(C,{cols:"12",md:"3"},{default:s(()=>[o(u,{modelValue:h.value,"onUpdate:modelValue":n[2]||(n[2]=t=>h.value=t),items:k.value,"item-title":t=>t.name,"item-value":t=>t.id,label:"University",placeholder:"Select University",clearable:""},null,8,["modelValue","items","item-title","item-value"])]),_:1}),v.value?(D(),N(C,{key:1,cols:"12",md:"3"},{default:s(()=>[o(u,{modelValue:g.value,"onUpdate:modelValue":n[3]||(n[3]=t=>g.value=t),items:w.value,"item-title":t=>t.name,"item-value":t=>t.id,label:"Application Officer",placeholder:"Select Application Officer",clearable:""},null,8,["modelValue","items","item-title","item-value"])]),_:1})):$("",!0),o(C,{cols:"12",md:"3"},{default:s(()=>[o(r,{modelValue:A.value,"onUpdate:modelValue":n[4]||(n[4]=t=>A.value=t),label:"From Date",placeholder:"Select From Date"},null,8,["modelValue"])]),_:1}),o(C,{cols:"12",md:"3"},{default:s(()=>[o(r,{modelValue:U.value,"onUpdate:modelValue":n[5]||(n[5]=t=>U.value=t),label:"To Date",placeholder:"Select To Date"},null,8,["modelValue"])]),_:1})],64)}}},Ve={class:"application-list-container"},xe={class:"me-3 d-flex gap-3"},Ue={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},be={style:{"inline-size":"15.625rem"}},Ce={class:"d-flex flex-column"},ke={class:"d-block font-weight-medium text-truncate text-high-emphasis"},we={class:"text-md"},Pe={class:"d-flex flex-column ms-3"},De={class:"d-block font-weight-medium text-truncate text-high-emphasis"},Oe={class:"text-md"},Te={class:"text-md"},Be={class:"d-flex flex-column ms-3"},Ie={__name:"index",props:{userId:{type:String,default:null}},setup(T){const B=T,{can:I}=_e(),k=z(),O=pe();a(M()==="admin");const w=a([]),x=a(0),f=a(10),v=a(1),p=a(),c=a(),_=a(""),y=a(null),h=a(null),g=a(null),A=a(null),U=a(""),b=a(null),i=a(null),n=a(!1);z();const u=async()=>{n.value=!0;try{const m=await k.getApplicationList(B.userId,v.value,f.value,_.value,p.value,c.value,y.value,h.value,g.value,A.value,U.value,b.value,i.value);w.value=m.data,x.value=m.total}catch(m){console.error("Error fetching applications:",m)}finally{n.value=!1}},r=m=>{var l,P;p.value=(l=m.sortBy[0])==null?void 0:l.key,c.value=(P=m.sortBy[0])==null?void 0:P.order,u()},t=m=>{O.push({name:"application-details",params:{id:m}})},J=async m=>{if((await F.fire({title:"Are you sure?",text:"Do you want to delete this item?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed)try{await k.deleteItem(m),u(),F.fire("Deleted!","The item has been deleted.","success")}catch{F.fire("Error!","There was an error deleting the item.","error")}};V([_,y,h,g,A,U,b,i],()=>{u()}),Y(()=>{u()});const K=a([{title:"APPLICATION ID",key:"application_id"},{title:"Student Name",key:"student.name"},{title:"Student Email",key:"student.email"},...I("application-control-officer-view","application")?[{title:"Application Control Officer",key:"user.parent.email"}]:[],{title:"Channel Partner",key:"user.email"},{title:"University/Course Details",key:"university.name"},{title:"Status",key:"status"},{title:"Date Added",key:"created_at"},{title:"Action",key:"action",sortable:!1}]),Q=ce(()=>"calc(100vh - 200px)");return(m,l)=>{const P=oe,W=le,L=fe("IconBtn"),X=ae,Z=te;return D(),G("div",Ve,[o(Z,{title:"Application List",loading:n.value,"no-actions":""},{default:s(()=>[o(H,null,{default:s(()=>[o(de,null,{default:s(()=>[o(Se,{"selected-status":y.value,"selected-channel-partner":g.value,"selected-university":h.value,"selected-application-officer":A.value,"selected-date-from":b.value,"selected-date-to":i.value,onUpdateStatus:l[0]||(l[0]=e=>y.value=e),onUpdateChannelPartner:l[1]||(l[1]=e=>g.value=e),onUpdateUniversity:l[2]||(l[2]=e=>h.value=e),onUpdateApplicationOfficer:l[3]||(l[3]=e=>A.value=e),onUpdateDateFrom:l[4]||(l[4]=e=>b.value=e),onUpdateDateTo:l[5]||(l[5]=e=>i.value=e)},{default:s(()=>[E(' :isAdmin = "isAdmin" ')]),_:1},8,["selected-status","selected-channel-partner","selected-university","selected-application-officer","selected-date-from","selected-date-to"])]),_:1})]),_:1}),o(H,{class:"d-flex flex-wrap gap-4"},{default:s(()=>[d("div",xe,[o(P,{"model-value":f.value,items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:100},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":l[6]||(l[6]=e=>f.value=parseInt(e,10))},null,8,["model-value"])]),o(he),d("div",Ue,[d("div",be,[o(W,{modelValue:_.value,"onUpdate:modelValue":l[7]||(l[7]=e=>_.value=e),placeholder:"Search Application"},null,8,["modelValue"])])])]),_:1}),o(ge,{"items-per-page":f.value,"onUpdate:itemsPerPage":l[9]||(l[9]=e=>f.value=e),page:v.value,"onUpdate:page":l[10]||(l[10]=e=>v.value=e),items:w.value,"items-length":x.value,headers:K.value,class:"text-no-wrap color-black application-table",height:Q.value,"onUpdate:options":r},{"item.student.name":s(({item:e})=>[d("p",null,S(e.student.first_name)+" "+S(e.student.last_name),1)]),"item.user.email":s(({item:e})=>[d("div",Ce,[d("span",ke,S(e.user.company_name),1),d("span",we,S(e.user.email),1)])]),"item.university.name":s(({item:e})=>[d("div",Pe,[d("span",De,S(e.university.name),1),d("span",Oe,S(e.course.name),1),d("span",Te,S(e.intake.name),1)])]),"item.status":s(({item:e})=>[o(Ae,{color:R(q)(e.status),class:ve([`text-${R(q)(e.status)}`,"font-weight-medium"]),size:"small"},{default:s(()=>[E(S(R(me)(e.status)),1)]),_:2},1032,["color","class"])]),"item.action":s(({item:e})=>[d("div",Be,[o(L,{onClick:ee=>t(e.application_id)},{default:s(()=>[o(j,{icon:"tabler-eye"})]),_:2},1032,["onClick"]),m.$can("delete","application")?(D(),N(L,{key:0,onClick:ee=>J(e.id)},{default:s(()=>[o(j,{icon:"tabler-trash"})]),_:2},1032,["onClick"])):$("",!0)])]),bottom:s(()=>[o(X,{page:v.value,"onUpdate:page":l[8]||(l[8]=e=>v.value=e),"items-per-page":f.value,"total-items":x.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","items","items-length","headers","height"])]),_:1},8,["loading"])])}}},Tt=ye(Ie,[["__scopeId","data-v-16e9918a"]]);export{Tt as default};
