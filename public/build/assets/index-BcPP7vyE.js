import{_ as W}from"./AppCardActions-XihjTES7.js";import{_ as X}from"./TablePagination-Cxyu5gIm.js";import{_ as Z}from"./AppTextField-B-rmcS8Q.js";import{_ as ee}from"./AppSelect-RTworqoT.js";import{u as D}from"./applicationList-BRHa4Blm.js";import{c as te}from"./commonFunction-DTs6G0PV.js";import{u as ae}from"./user-DfCOlgnu.js";import{S as _}from"./sweetalert2-z6gKu1nJ.js";import{k as oe,r as a,w as se,H as ne,a as ie,o as N,c as le,b as n,e as i,d as s,x as r,y as re,v as ce,a1 as b,f as me,z as pe}from"./main-CD3DO1cI.js";import{g as de}from"./helpers-_i9Eo8Ic.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as fe}from"./VCardText-DkFOyiZ-.js";import{V as ve}from"./VSpacer-Cm5rs5Xo.js";import{V as _e}from"./VDataTableServer-Nc7UN3A4.js";import{V as ge}from"./VChip-CFsQOGvx.js";import"./index-BFBcAkwT.js";import"./VCard-wQXXJrcy.js";import"./VAvatar-CSRGa55d.js";import"./VImg-y8xT9LZr.js";import"./index-Dexl601c.js";import"./VOverlay-C7kM16v3.js";import"./easing-CjukEv2V.js";import"./lazy-BK9MsVhP.js";import"./scopeId-Rh7KIkaM.js";import"./VDivider-BRzsECtw.js";import"./VPagination-Z-VozIcx.js";import"./form-CwGlIemn.js";import"./VTextField-DqTh2h2v.js";/* empty css                   */import"./VCounter-CF0nIJef.js";import"./VField-BMtnNiUl.js";import"./VInput-BLH_JNr0.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-Btvms4Sd.js";import"./VList-DvUmm7JN.js";import"./ssrBoot-BcFPKAFv.js";import"./dialog-transition-DMVIyBmw.js";import"./VMenu-B3H3xvLD.js";import"./VCheckboxBtn-CBG9E5PA.js";import"./VSelectionControl-D-JKdoOf.js";import"./api-OMzlMY0H.js";import"./index-B3bPRkoL.js";/* empty css              */import"./VDataTable-pUd0hm_M.js";import"./VTable-FlSqViHf.js";import"./filter-CqmGSPKM.js";import"./VSlideGroup-CSMRPflH.js";const he={class:"me-3 d-flex gap-3"},ye={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},xe={style:{"inline-size":"15.625rem"}},Ae={class:"d-flex flex-column"},we={class:"d-block font-weight-medium text-truncate text-high-emphasis"},Ce={class:"text-md"},Se={class:"d-flex flex-column ms-3"},ke={class:"d-block font-weight-medium text-truncate text-high-emphasis"},Pe={class:"text-md"},Ie={class:"text-md"},Ve={class:"d-flex flex-column ms-3"},Ue={__name:"index",props:{userId:{type:String,default:null}},setup(R){const g=D(),h=ae(),O=oe(),T=a(de()==="admin"),y=a([]),f=a(0),m=a(10),p=a(1),x=a(),A=a(),d=a(""),w=a(null),C=a(null),S=a(null),k=a(null),P=a(""),I=a(null),V=a(null),v=a(!1),E=a([]),$=a([]),L=a([]);D();const z=te();a([{id:0,name:"Application Processing"},{id:1,name:"Application Submitted"},{id:2,name:"Pending Docs"},{id:3,name:"Offer Issue Conditional"},{id:4,name:"Offer Issue Unconditional"},{id:5,name:"Need Payment"},{id:6,name:"CAS Issued"},{id:7,name:"Additional Doc Needed"},{id:8,name:"Refund Required"},{id:9,name:"Application Rejected"},{id:10,name:"Session Expired"},{id:11,name:"Doc Received"},{id:12,name:"Partial Payment"}]);const F=R,u=async()=>{v.value=!0;try{const t=await g.getApplicationList(F.userId,p.value,m.value,d.value,x.value,A.value,w.value,C.value,S.value,k.value,P.value,I.value,V.value);y.value=t.data,f.value=t.total}catch(t){console.error("Error fetching applications:",t)}finally{v.value=!1}},j=t=>{var o,c;x.value=(o=t.sortBy[0])==null?void 0:o.key,A.value=(c=t.sortBy[0])==null?void 0:c.order,u()},q=t=>{O.push({name:"application-details",params:{id:t}})},H=async t=>{if((await _.fire({title:"Are you sure?",text:"Do you want to delete this item?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed)try{await g.deleteItem(t),u(),_.fire("Deleted!","The item has been deleted.","success")}catch{_.fire("Error!","There was an error deleting the item.","error")}},M=async()=>{try{const t=await z.getUniversities();E.value=t.data.map(l=>({id:l.id,name:l.name}));const o=await h.fetchUsers(1,"","channel partner","",!0);$.value=o.data.map(l=>({id:l.id,name:l.company_name_with_email}));const c=await h.fetchUsers(1,"","application control officer","",!0);L.value=c.data.map(l=>({id:l.id,name:l.name_with_email}))}catch(t){console.error("Error fetching filter options:",t)}};se([d,w,C,S,k,P,I,V],()=>{u()}),ne(()=>{M(),u()});const Y=a([{title:"APPLICATION ID",key:"application_id"},{title:"Student Name",key:"student.name"},{title:"Student Email",key:"student.email"},...T.value?[{title:"Application Officer",key:"user.parent.email"}]:[],{title:"Channel Partner",key:"user.email"},{title:"University/Course Details",key:"university.name"},{title:"Status",key:"status"},{title:"Date Added",key:"created_at"},{title:"Action",key:"action",sortable:!1}]),U=t=>({0:"primary",1:"success",2:"warning",3:"info",4:"info",5:"warning",6:"success",7:"warning",8:"danger",9:"danger",10:"secondary",11:"success",12:"warning"})[t]||"secondary",G=t=>({0:"Application Processing",1:"Application Submitted",2:"Pending Docs",3:"Offer Issue Conditional",4:"Offer Issue Unconditional",5:"Need Payment",6:"CAS Issued",7:"Additional Doc Needed",8:"Refund Required",9:"Application Rejected",10:"Session Expired",11:"Doc Received",12:"Partial Payment"})[t]||"Unknown Status";return(t,o)=>{const c=ee,l=Z,B=ie("IconBtn"),J=X,K=W;return N(),le("div",null,[n(K,{title:"New Application",loading:v.value,"no-actions":""},{default:i(()=>[n(fe,{class:"d-flex flex-wrap gap-4"},{default:i(()=>[s("div",he,[n(c,{"model-value":m.value,items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:100},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":o[0]||(o[0]=e=>m.value=parseInt(e,10))},null,8,["model-value"])]),n(ve),s("div",ye,[s("div",xe,[n(l,{modelValue:d.value,"onUpdate:modelValue":o[1]||(o[1]=e=>d.value=e),placeholder:"Search Application"},null,8,["modelValue"])])])]),_:1}),n(_e,{"items-per-page":m.value,"onUpdate:itemsPerPage":o[3]||(o[3]=e=>m.value=e),page:p.value,"onUpdate:page":o[4]||(o[4]=e=>p.value=e),items:y.value,"items-length":f.value,headers:Y.value,class:"text-no-wrap color-black","onUpdate:options":j},{"item.student.name":i(({item:e})=>[s("p",null,r(e.student.first_name)+" "+r(e.student.last_name),1)]),"item.user.email":i(({item:e})=>[s("div",Ae,[s("span",we,r(e.user.company_name),1),s("span",Ce,r(e.user.email),1)])]),"item.university.name":i(({item:e})=>[s("div",Se,[s("span",ke,r(e.university.name),1),s("span",Pe,r(e.course.name),1),s("span",Ie,r(e.intake.name),1)])]),"item.status":i(({item:e})=>[n(ge,{color:U(e.status),class:re([`text-${U(e.status)}`,"font-weight-medium"]),size:"small"},{default:i(()=>[ce(r(G(e.status)),1)]),_:2},1032,["color","class"])]),"item.action":i(({item:e})=>[s("div",Ve,[n(B,{onClick:Q=>q(e.id)},{default:i(()=>[n(b,{icon:"tabler-eye"})]),_:2},1032,["onClick"]),t.$can("delete","application")?(N(),me(B,{key:0,onClick:Q=>H(e.id)},{default:i(()=>[n(b,{icon:"tabler-trash"})]),_:2},1032,["onClick"])):pe("",!0)])]),bottom:i(()=>[n(J,{page:p.value,"onUpdate:page":o[2]||(o[2]=e=>p.value=e),"items-per-page":m.value,"total-items":f.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","items","items-length","headers"])]),_:1},8,["loading"])])}}},Ct=ue(Ue,[["__scopeId","data-v-481e7a5d"]]);export{Ct as default};
