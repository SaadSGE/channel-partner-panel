import{_ as K}from"./TablePagination-bQdRRFE-.js";import{_ as X}from"./ShowMore-CxqSaCOD.js";import{_ as O}from"./AppSelect-DjLpGozG.js";import{_ as Y}from"./AppTextField-CI2sYldC.js";import{u as W,f as Z}from"./format-DegEVtf1.js";import{u as ee}from"./applicationList-C9rVXruQ.js";import"./commonFunction-BsJR8SjE.js";import{u as te}from"./recordStore-BN4IUMgJ.js";import{u as oe}from"./user-CLUqZAaG.js";import{f as se,g as ne,d as j}from"./helpers-YGoCGHBz.js";import{_ as le}from"./AppDateTimePicker-KdOzAee1.js";import{V as x}from"./VCardText-C2Oo_j0o.js";import{V as B,a as b}from"./VRow-FTJPtNdd.js";import{V as ae}from"./VDivider-OHBkfnHv.js";import{V as G}from"./VDataTableServer-CN_cVwfe.js";import{V as re}from"./VChip-CjLdXuEH.js";import{V as S,b as H,a as ie,d as ue}from"./VCard-B4i4FYqK.js";import{r,w as de,H as J,o as d,f as h,e as a,b as s,v as l,x as n,n as w,c as _,d as e,j as pe,k as ce,F as z,i as M,z as R,a2 as Q,a8 as _e}from"./main-8aVYLUVs.js";import me from"./index-Bg5WDryk.js";import ge from"./UserBioPanel-DJbN7ap4.js";import"./VPagination-Bflw3fYp.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VTextField-CLQDVmZC.js";import"./index-w0WQ-EFw.js";import"./index-BTZYhcqc.js";import"./forwardRefs-D3j0TLhE.js";import"./VSelect-DMfkPvob.js";import"./VList-D-5QTnJH.js";import"./ssrBoot-BwOI1Sa3.js";import"./VAvatar-Bqaild5s.js";import"./VImg-BJscc2_e.js";import"./dialog-transition-C1Ydo0St.js";import"./lazy-_Z555AJ6.js";import"./scopeId-iQUdPPGy.js";import"./VMenu-DhJ_h--r.js";import"./VCheckboxBtn-Dy8FhCWc.js";/* empty css              */import"./VDataTable-Boa6c3RD.js";import"./VTable-B8Hvg_Dd.js";import"./filter-CTqZDCLQ.js";import"./VSlideGroup-DKoRFvIH.js";import"./AppCardActions-9YR4z4xM.js";import"./Filters-DjcGBGuJ.js";import"./AppAutocomplete-C3R4CqCn.js";import"./rolePermission-BemDoopm.js";import"./sweetalert2-z6gKu1nJ.js";import"./useAbility-4bKsTjcK.js";import"./VSpacer-Ct4oYk_Q.js";import"./VBadge-BcY1gMNE.js";import"./formatters-DULOiX1-.js";import"./VDialog-vPf1SS7v.js";import"./DialogCloseBtn-CWMZk_0u.js";import"./VForm-BrpDewqy.js";import"./VSwitch-DuF0iA6_.js";const ve={key:0},fe=e("strong",null,"Application ID:",-1),ye=e("br",null,null,-1),he=e("strong",null,"Student Name:",-1),be=e("br",null,null,-1),ke=e("strong",null,"Student Email:",-1),Ue=e("br",null,null,-1),Ve=e("strong",null,"University:",-1),Ae=e("br",null,null,-1),Se=e("strong",null,"Intake:",-1),we={key:1},xe=e("strong",null,"Application ID:",-1),Ce=e("br",null,null,-1),De=e("strong",null,"Student Email:",-1),Ie=e("br",null,null,-1),Pe=e("strong",null,"New Status:",-1),Le=e("br",null,null,-1),Te=e("strong",null,"Old Status:",-1),$e=e("br",null,null,-1),qe=e("strong",null,"Student Email:",-1),Ne=e("br",null,null,-1),Re=e("strong",null,"University:",-1),Be=e("br",null,null,-1),Ee=e("strong",null,"Intake:",-1),je=e("br",null,null,-1),ze={key:2},Fe=e("strong",null,"Application ID:",-1),He=e("br",null,null,-1),Me=e("strong",null,"Student Email:",-1),Qe=e("br",null,null,-1),Ke=e("strong",null,"University:",-1),Oe=e("br",null,null,-1),We=e("strong",null,"Intake:",-1),Ge=e("br",null,null,-1),Je=e("strong",null,"Document Name:",-1),Xe={key:3},Ye=e("strong",null,"Application ID:",-1),Ze=e("br",null,null,-1),et=e("strong",null,"Student Email:",-1),tt=e("br",null,null,-1),ot=e("strong",null,"University:",-1),st=e("br",null,null,-1),nt=e("strong",null,"Intake:",-1),lt=e("br",null,null,-1),at=e("strong",null,"Comment:",-1),rt={key:4},it=e("strong",null,"Application ID:",-1),ut=e("br",null,null,-1),dt=e("strong",null,"Student Email:",-1),pt=e("br",null,null,-1),ct=e("strong",null,"University:",-1),_t=e("br",null,null,-1),mt=e("strong",null,"Intake:",-1),gt=e("br",null,null,-1),vt=e("strong",null,"Subject:",-1),ft={key:5},yt=e("strong",null,"University Name:",-1),ht=e("br",null,null,-1),bt=e("strong",null,"Course Name:",-1),kt=e("br",null,null,-1),Ut=e("strong",null,"Intake:",-1),Vt={key:6},At=e("strong",null,"Error:",-1),St=e("br",null,null,-1),wt=e("strong",null,"University Name:",-1),xt=e("br",null,null,-1),Ct=e("strong",null,"Course Name:",-1),Dt=e("br",null,null,-1),It=e("strong",null,"Intake:",-1),Pt={key:7},Lt={__name:"UserActivityLog",props:{userId:{type:String,required:!0}},setup(F){const k=F,m=W(),D=r([]),C=r(!1),p=r(0),c=r(1),g=r(10),I=r(""),U=r(null),v=r(null),V=r(null),P=[{title:"Login",value:"login"},{title:"Logout",value:"logout"},{title:"Application Submit",value:"application_submit"},{title:"Application Update",value:"application_update"},{title:"Document Upload",value:"document_upload"}],L=[{title:"Date",key:"created_at",sortable:!0},{title:"Activity Type",key:"description",sortable:!0},{title:"Details",key:"details",sortable:!1},{title:"IP Address",key:"ip_address",sortable:!1}],f=async()=>{C.value=!0;try{m.setPage(c.value),m.setPerPage(g.value),m.setActivityType(U.value),m.setSearchQuery(I.value),m.setDateFrom(v.value),m.setDateTo(V.value);const i=await m.fetchUserActivityLogs(k.userId);D.value=i.data.data.map(o=>({...o,created_at:Z(new Date(o.created_at),"yyyy-MM-dd HH:mm:ss"),ip_address:o.properties.ip||"N/A",details:y(o)})),p.value=i.data.total}catch(i){console.error("Error fetching activity logs:",i)}finally{C.value=!1}},y=i=>{switch(i.description){case"login":return"User logged in";case"logout":return"User logged out";case"profile_update":return"Updated profile information";case"password_change":return"Changed password";case"application_submit":return`Submitted application #${i.properties.application_id}`;case"application_update":return`Updated application #${i.properties.application_id}`;case"document_upload":return`Uploaded document: ${i.properties.document_name||"Unknown"}`;case"comment_add":return`Added comment to application #${i.properties.application_id||"Unknown"}`;default:return i.description||"Performed an action"}},A=i=>{switch(i){case"login":return"success";case"logout":return"warning";case"application_submit":return"primary";case"application_status_update":return"info";case"document_upload":return"secondary";case"comment_added":return"success";case"university_communication_added":return"info";case"course_request_submitted":return"primary";case"course_request_failed":return"error";case"profile_update":return"secondary";case"password_change":return"warning";default:return"default"}},E=i=>{c.value=i.page,g.value=i.itemsPerPage,i.sortBy&&i.sortBy.length>0&&m.setSorting(i.sortBy[0].key,i.sortBy[0].order),f()};return de([I,U,v,V],()=>{c.value=1,f()}),J(()=>{f()}),(i,o)=>{const T=O,$=le,q=K;return d(),h(S,{title:"User Activity Log",class:"mt-5"},{default:a(()=>[s(x,null,{default:a(()=>[s(B,{class:"d-flex justify-end align-center"},{default:a(()=>[s(b,{cols:"12",sm:"6",md:"3"},{default:a(()=>[s(T,{modelValue:U.value,"onUpdate:modelValue":o[0]||(o[0]=t=>U.value=t),items:P,placeholder:"Select Activity Type",clearable:""},null,8,["modelValue"])]),_:1}),s(b,{cols:"12",sm:"6",md:"3"},{default:a(()=>[s($,{modelValue:v.value,"onUpdate:modelValue":o[1]||(o[1]=t=>v.value=t),placeholder:"Select From Date"},null,8,["modelValue"])]),_:1}),s(b,{cols:"12",sm:"6",md:"3"},{default:a(()=>[s($,{modelValue:V.value,"onUpdate:modelValue":o[2]||(o[2]=t=>V.value=t),placeholder:"Select To Date"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(ae),s(x,null,{default:a(()=>[s(B,{class:"d-flex justify-end align-center"},{default:a(()=>[s(b,{cols:"auto"},{default:a(()=>[s(T,{modelValue:g.value,"onUpdate:modelValue":[o[3]||(o[3]=t=>g.value=t),o[4]||(o[4]=t=>g.value=parseInt(t,10))],items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],label:"Items per page",style:{"inline-size":"8rem"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(G,{"items-per-page":g.value,"onUpdate:itemsPerPage":o[6]||(o[6]=t=>g.value=t),page:c.value,"onUpdate:page":o[7]||(o[7]=t=>c.value=t),items:D.value,"items-length":p.value,headers:L,loading:C.value,class:"text-no-wrap","onUpdate:options":E},{"item.description":a(({item:t})=>[s(re,{color:A(t.description),size:"small"},{default:a(()=>[l(n(w(se)(t.description)),1)]),_:2},1032,["color"])]),"item.details":a(({item:t})=>[t.description==="application_submit"?(d(),_("div",ve,[fe,l(" "+n(t.properties.application_id),1),ye,he,l(" "+n(t.properties.student_name),1),be,ke,l(" "+n(t.properties.student_email),1),Ue,Ve,l(" "+n(t.properties.university_name),1),Ae,Se,l(" "+n(t.properties.intake_name),1)])):t.description==="application_status_update"?(d(),_("div",we,[xe,l(" "+n(t.properties.application_id),1),Ce,De,l(" "+n(t.properties.student_email),1),Ie,Pe,l(" "+n(t.properties.new_status),1),Le,Te,l(" "+n(t.properties.old_status),1),$e,qe,l(" "+n(t.properties.student_email),1),Ne,Re,l(" "+n(t.properties.university_name),1),Be,Ee,l(" "+n(t.properties.intake_name),1),je])):t.description==="document_upload"?(d(),_("div",ze,[Fe,l(" "+n(t.properties.application_id),1),He,Me,l(" "+n(t.properties.student_email),1),Qe,Ke,l(" "+n(t.properties.university_name),1),Oe,We,l(" "+n(t.properties.intake_name),1),Ge,Je,l(" "+n(t.properties.document_name),1)])):t.description==="comment_added"?(d(),_("div",Xe,[Ye,l(" "+n(t.properties.application_id),1),Ze,et,l(" "+n(t.properties.student_email),1),tt,ot,l(" "+n(t.properties.university_name),1),st,nt,l(" "+n(t.properties.intake_name),1),lt,at,l(" "+n(t.properties.comment),1)])):t.description==="university_communication_added"?(d(),_("div",rt,[it,l(" "+n(t.properties.application_id),1),ut,dt,l(" "+n(t.properties.student_email),1),pt,ct,l(" "+n(t.properties.university_name),1),_t,mt,l(" "+n(t.properties.intake_name),1),gt,vt,l(" "+n(t.properties.subject),1)])):t.description==="course_request_submitted"?(d(),_("div",ft,[yt,l(" "+n(t.properties.university_name),1),ht,bt,l(" "+n(t.properties.course_name),1),kt,Ut,l(" "+n(t.properties.intake),1)])):t.description==="course_request_failed"?(d(),_("div",Vt,[At,l(" "+n(t.properties.error),1),St,wt,l(" "+n(t.properties.university_name),1),xt,Ct,l(" "+n(t.properties.course_name),1),Dt,It,l(" "+n(t.properties.intake),1)])):(d(),_("div",Pt,n(t.details),1))]),bottom:a(()=>[s(q,{page:c.value,"onUpdate:page":o[5]||(o[5]=t=>c.value=t),"items-per-page":g.value,"total-items":p.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","items","items-length","loading"])]),_:1})}}},Tt={class:"d-flex align-center justify-space-between gap-x-2"},$t={class:"text-h4 text-center"},qt=["href"],Nt={class:"d-flex justify-space-between flex-wrap gap-6"},Rt={class:"d-flex flex-row gap-4 align-center flex-wrap"},jo={__name:"[id]",setup(F){const k=pe();r(null),ce();const m=te(),D=r(ne()==="admin");r();const C=oe();ee();const p=r({dashboard:{applications_by_status:{application_processing:0,application_submitted:0,pending_docs:0,offer_issue_conditional:0,offer_issue_unconditional:0,need_payment:0,cas_issued:0,additional_doc_needed:0,refund_required:0,application_rejected:0,session_expired:0,doc_received:0,partial_payment:0}}}),c=r(""),g=r(!1);W(),r([]),r(!1),r(0),r({page:1,itemsPerPage:10,sortBy:[{key:"created_at",order:"desc"}]}),J(async()=>{p.value=await C.fetchUser(k.params.id),P.value=p.value.documents||[]});const I=i=>{const o=document.createElement("a");o.href=i,o.target="_blank",o.download="test",document.body.appendChild(o),o.click(),document.body.removeChild(o)},U=async(i=1)=>{const o=await m.fetchRecord(i,c.value,k.params.id);L.value=o.data,f.value=o.total},v=i=>i.replace(/_/g," ").replace(/\b\w/g,o=>o.toUpperCase()),V=[{title:"Country",key:"country.name"},{title:"Intake",key:"intake.name"},{title:"University",key:"university.name"},{title:"Course Type",key:"course.type"},{title:"Course Name",key:"course.name"},{title:"Tution Fee",key:"tuition_fee"},{title:"Course Duration",key:"course_duration"},{title:"Academic Requirement",key:"academic_requirement"},{title:"English Requirement",key:"english_requirement"},{title:"Actions",key:"actions",sortable:!1}],P=r([]);r(""),r(""),r(""),r("");const L=r(),f=r(),y=r(10),A=r(1),E=i=>{U(i.page)};return r([]),r(0),r(),r(),(i,o)=>{const T=Y,$=O,q=X,t=K;return d(),_(z,null,[s(B,null,{default:a(()=>[s(b,{cols:"12",md:"5",lg:"4"},{default:a(()=>[s(ge,{"user-data":p.value},null,8,["user-data"])]),_:1}),s(b,{cols:"12",md:"4",sm:"6",lg:"8"},{default:a(()=>[s(B,null,{default:a(()=>[(d(!0),_(z,null,M(p.value.dashboard.applications_by_status,(u,N)=>(d(),h(b,{cols:"12",md:"5",lg:"4",key:N},{default:a(()=>[s(S,null,{default:a(()=>[s(ie,{class:"pb-3"},{default:a(()=>[s(H,null,{default:a(()=>[l(n(v(N)),1)]),_:2},1024),s(ue,null,{default:a(()=>[l("Last Week")]),_:1})]),_:2},1024),s(x,null,{default:a(()=>[e("div",Tt,[e("h4",$t,n(u),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),w(j)(p.value.role,"editor")?R("",!0):(d(),h(S,{key:0,class:"mt-5"},{default:a(()=>[s(me,{userId:w(k).params.id},null,8,["userId"])]),_:1})),w(j)(p.value.role,"channel partner")?(d(),h(S,{key:1,class:"mt-5"},{default:a(()=>[s(H,null,{default:a(()=>[l("Documents")]),_:1}),s(x,null,{default:a(()=>[(d(!0),_(z,null,M(P.value,(u,N)=>(d(),h(S,{key:N,class:"mb-2"},{default:a(()=>[s(x,{class:"d-flex justify-space-between align-center"},{default:a(()=>[e("div",null,[s(Q,{size:"26",color:"red",icon:"tabler-file-type-doc"}),e("a",{href:u.document_path,target:"_blank"},n(v(u.document_type)),9,qt)]),s(_e,{icon:"",onClick:Bt=>I(u.document_path)},{default:a(()=>[s(Q,{size:"24",icon:"tabler-eye"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):R("",!0),w(j)(p.value.role,"editor")?(d(),h(S,{key:2,title:"Course Details",class:"mt-2"},{default:a(()=>[s(x,null,{default:a(()=>[e("div",Nt,[e("div",null,[s(T,{modelValue:c.value,"onUpdate:modelValue":o[0]||(o[0]=u=>c.value=u),style:{"max-inline-size":"200px","min-inline-size":"200px"},placeholder:"Search Record"},null,8,["modelValue"])]),e("div",Rt,[s($,{modelValue:y.value,"onUpdate:modelValue":o[1]||(o[1]=u=>y.value=u),items:[10,25,50,100],style:{"inline-size":"6.25rem"}},null,8,["modelValue"])])])]),_:1}),s(G,{"items-per-page":y.value,"onUpdate:itemsPerPage":o[3]||(o[3]=u=>y.value=u),page:A.value,"onUpdate:page":o[4]||(o[4]=u=>A.value=u),loading:g.value,"items-length":f.value,headers:V,items:L.value,"item-value":"total",class:"text-no-wrap text-sm rounded-0","onUpdate:options":E},{"item.academic_requirement":a(({item:u})=>[s(q,{text:u.academic_requirement,lines:3},null,8,["text"])]),"item.english_requirement":a(({item:u})=>[s(q,{text:u.english_requirement,lines:3},null,8,["text"])]),bottom:a(()=>[s(t,{page:A.value,"onUpdate:page":o[2]||(o[2]=u=>A.value=u),"items-per-page":y.value,"total-items":f.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","loading","items-length","items"])]),_:1})):R("",!0),D.value?(d(),h(Lt,{key:3,userId:w(k).params.id},null,8,["userId"])):R("",!0)],64)}}};export{jo as default};
