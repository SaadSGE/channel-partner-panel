import{_ as P}from"./AppAutocomplete-B4XpmGJY.js";import{_ as A}from"./Filters-9ZiEiMl9.js";import{c as q}from"./commonFunction-CPAn8OOM.js";import{u as z}from"./leadStore-ECnXd0gx.js";import{i as r}from"./index-C4dylgnC.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as O}from"./VCard-B7qhezZk.js";import{V as v,a as y}from"./VRow-C_WBmDjV.js";import{r as d,H as R,o as p,f as _,e as t,z as c,b as a,a9 as S,a2 as $,d as g,c as B,n as U,F,y as H,v as k,x as G,R as J,U as K}from"./main-BvFQxvBT.js";import{V as Q}from"./VFileInput-BTIGsDXT.js";import{V as W}from"./VCardText-DWakh8Y2.js";import"./VInput-DyyFC-H6.js";import"./index-Dgw-CaPr.js";import"./index-7dKs4xIn.js";import"./forwardRefs-D3j0TLhE.js";import"./VSelect-uA5monyM.js";import"./VTextField-CzYs9nDg.js";import"./VList-xrzE1bpy.js";import"./ssrBoot-HqMp4Sv1.js";import"./VAvatar-WzIA0iyC.js";import"./VImg-BMf7BfAR.js";import"./VDivider-CjM7G8NO.js";import"./dialog-transition-FkgYEYy3.js";import"./scopeId-dB-Pi8uf.js";import"./VMenu-CtZ79DNW.js";import"./VCheckboxBtn-Dd8JOE0x.js";import"./VChip-Bb7ACT6s.js";import"./filter-Dlys4yA2.js";import"./AppDateTimePicker-kqoNRpJg.js";import"./AppSelect-D5GmplFU.js";import"./AppTextField-DMqdYcKP.js";import"./rolePermission-jm7GwEP3.js";import"./helpers-Dq4Czwmk.js";import"./user-CDBmVU8h.js";/* empty css              */const x=n=>(J("data-v-3ec4adfb"),n=n(),K(),n),X=x(()=>g("span",{class:"text-h6 upload-title"},"Upload Lead Excel/csv File",-1)),Y={class:"form-padding mt-6 upload-form"},Z=x(()=>g("p",{class:"text-caption text-primary"},"Only Excel/CSV file support",-1)),ee=x(()=>g("span",{class:"font-weight-bold"},"Download Sample Excel/CSV File",-1)),le={__name:"upload-lead",props:{showUploadCard:Boolean},emits:["update:showUploadCard","leadsUploaded"],setup(n,{emit:E}){const L=n,b=E,I=z(),u=q(),m=d(null),s=d(null),o=d(null),C=d(null),f=d(!1),i=d(null);R(async()=>{await u.getAllCountries(),await u.getBranches()});const T=()=>{b("update:showUploadCard",!L.showUploadCard)},D=()=>{},j=V=>{i.value=V.target.files[0]},N=async()=>{if(!i.value){r.error("Please select a file to upload",{position:"top-right",theme:"colored"});return}if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(i.value.type)){r.error("Please upload only Excel or CSV files",{position:"top-right",theme:"colored"});return}if(o.value!=="event"&&!m.value){r.error("Please select a Country",{position:"top-right",theme:"colored"});return}if(!s.value){r.error("Please select a Branch",{position:"top-right",theme:"colored"});return}f.value=!0;try{const e=new FormData;e.append("file",i.value),e.append("assigned_branch",s.value),e.append("lead_country_id",m.value||""),e.append("lead_type",o.value||""),e.append("lead_event_id",C.value||""),await I.uploadLeads(e),s.value=null,m.value=null,document.querySelector('input[type="file"]')&&(document.querySelector('input[type="file"]').value=""),i.value=null,b("update:showUploadCard",!1),b("leadsUploaded"),r.success("File uploaded successfully!",{position:"top-right",theme:"colored"})}catch(e){const h=(e==null?void 0:e.message)||"Some records contain empty values.";r.error(h,{position:"top-right",theme:"colored"})}finally{f.value=!1}};return(V,e)=>{const h=A,w=P;return n.showUploadCard?(p(),_(O,{key:0,class:"mt-4 w-100 full-width-card upload-card"},{default:t(()=>[a(W,null,{default:t(()=>[a(v,{justify:"space-between",class:"align-center"},{default:t(()=>[X,a(S,{color:"error",icon:"",onClick:T,class:"close-btn"},{default:t(()=>[a($,{icon:"tabler-x"})]),_:1})]),_:1}),g("div",Y,[a(v,{class:"mb-4 fade-in"},{default:t(()=>[a(h,{"selected-lead-type":o.value,onUpdateLeadType:e[0]||(e[0]=l=>o.value=l),"country-label":"Lead Country","branch-label":"Lead Branch (Optional)"},null,8,["selected-lead-type"]),o.value==="social"?(p(),B(F,{key:0},[a(y,{cols:"12",md:"4"},{default:t(()=>[a(w,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),items:U(u).allCountries,"item-title":l=>l.name,"item-value":l=>l.id,label:"Select Country",placeholder:"Select Country",clearable:"",class:"slide-in"},null,8,["modelValue","items","item-title","item-value"])]),_:1}),a(y,{cols:"12",md:"4"},{default:t(()=>[a(w,{modelValue:s.value,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value=l),items:U(u).branches,"item-title":l=>l.name,"item-value":l=>l.id,label:"Select Branch",placeholder:"Select Branch",clearable:"",class:"slide-in"},null,8,["modelValue","items","item-title","item-value"])]),_:1})],64)):c("",!0),o.value==="event"?(p(),B(F,{key:1},[a(h,{"selected-event":C.value,onUpdateEvent:e[3]||(e[3]=l=>C.value=l)},null,8,["selected-event"]),a(y,{cols:"12",md:"4"},{default:t(()=>[a(w,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value=l),items:U(u).branches,"item-title":l=>l.name,"item-value":l=>l.id,label:"Select Branch",placeholder:"Select Branch",clearable:"",class:"slide-in"},null,8,["modelValue","items","item-title","item-value"])]),_:1})],64)):c("",!0)]),_:1}),o.value?(p(),_(v,{key:0,justify:"center",align:"center",class:"gap-4 fade-in"},{default:t(()=>[a(y,{cols:"12",md:"6"},{default:t(()=>[a(Q,{accept:".xlsx, .csv",label:"Upload Excel/CSV file",onChange:j,variant:"outlined",color:"purple-lighten-4",class:H(["file-input-animate",{"has-file":i.value}])},null,8,["class"])]),_:1}),a(S,{"prepend-icon":"tabler-cloud-upload",onClick:N,color:"purple-lighten-4",class:"upload-btn",loading:f.value,disabled:f.value},{default:t(()=>[k(G(f.value?"Uploading...":"Upload"),1)]),_:1},8,["loading","disabled"])]),_:1})):c("",!0),o.value?(p(),_(v,{key:1,justify:"center",class:"mt-2 fade-in"},{default:t(()=>[Z]),_:1})):c("",!0),o.value?(p(),_(v,{key:2,justify:"center",align:"center",class:"mt-6 gap-2 sample-section fade-in"},{default:t(()=>[ee,a(S,{"prepend-icon":"tabler-cloud-download",onClick:D,class:"download-btn btn-small",variant:"outlined"},{default:t(()=>[k(" Download Sample ")]),_:1})]),_:1})):c("",!0)])]),_:1})]),_:1})):c("",!0)}}},Pe=M(le,[["__scopeId","data-v-3ec4adfb"]]);export{Pe as default};
