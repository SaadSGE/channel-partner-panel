import{_ as de}from"./TablePagination-BJAuaG3-.js";import{_ as pe}from"./AppSelect-BYZUlbfh.js";import{u as me,f as R}from"./format-COBunm2h.js";import{u as j}from"./applicationList-BZalZQjK.js";import{f as fe}from"./helpers-B6UT3l9l.js";import{V as k}from"./VCardText-B7x7b_F3.js";import{V as _e}from"./VDivider-DLQBYBVj.js";import{V as ve}from"./VDataTableServer-Dz8NDwAY.js";import{V as F}from"./VChip-CjcgH7Gn.js";import{V as I,b as $,d as Y}from"./VCard-N5Ac_lHY.js";import{r as g,w as K,H,o as f,f as T,e,b as t,d as r,v as s,x as v,n as E,c as O,F as S,z as ge,a7 as B,a1 as z,i as q,a6 as Q,an as G,a5 as P,R as J,U as W}from"./main-C74_jUeT.js";/* empty css                         */import{a as L,V as D}from"./VRow-26QtYvrR.js";import{V as X,a as Z}from"./VTimelineItem-CunYPZaz.js";import{V as ee}from"./VForm-Da8LGrcf.js";import{V as te}from"./form-Dm2p5Mi6.js";import{V as ae}from"./VSpacer-Db9bO5N5.js";import{V as oe}from"./VDialog-B3MIKbs5.js";import{_ as se}from"./AppAutocomplete-DmxyimUH.js";import{S as M}from"./sweetalert2-z6gKu1nJ.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as ne}from"./VTable-DSnnPAOF.js";import{V as ie}from"./VAlert-KwjpbTzh.js";const ye={class:"d-flex justify-space-between flex-wrap gap-6"},Ae={class:"me-3 d-flex gap-3"},Ce=r("br",null,null,-1),we={key:0},ot={__name:"ApplicationActivityLog",props:{applicationId:{type:String,required:!0}},setup(w){const h=w,c=me(),n=g([]),y=g(!1),x=g(0),u=g(1),_=g(10),V=g(""),b=g(null),A=[{title:"Date",key:"created_at",sortable:!0},{title:"User",key:"user",sortable:!0},{title:"Activity Type",key:"description",sortable:!0},{title:"Details",key:"details",sortable:!1},{title:"IP Address",key:"ip_address",sortable:!1}],d=async()=>{y.value=!0;try{c.setPage(u.value),c.setPerPage(_.value),c.setActivityType(b.value),c.setSearchQuery(V.value);const i=await c.fetchApplicationActivityLogs(h.applicationId);n.value=i.data.data.map(m=>({...m,created_at:R(new Date(m.created_at),"yyyy-MM-dd HH:mm:ss"),ip_address:m.properties.ip||"N/A",details:o(m),user:m.user?m.user.name:"System"})),x.value=i.data.total}catch(i){console.error("Error fetching activity logs:",i)}finally{y.value=!1}},p=j(),a=g([]),o=i=>{switch(i.description){case"application_submit":return`Submitted application #${i.properties.application_id}`;case"application_update":return`Updated application #${i.properties.application_id}`;case"document_upload":return`Uploaded document: ${i.properties.document_name||"Unknown"}`;case"comment_added":return`Added comment to application #${i.properties.application_id||"Unknown"}`;case"application_status_update":const m=U(i.properties.old_status),N=U(i.properties.new_status);return`Updated status from ${m} to ${N}`;default:return i.description||"Performed an action"}},U=i=>{const m=a.value.find(N=>N.id===parseInt(i));return m?m.name:"Unknown"},C=i=>{switch(i){case"application_submit":return"primary";case"application_update":return"info";case"document_upload":return"success";case"comment_added":return"warning";case"application_status_update":return"error";default:return"default"}},re=i=>{u.value=i.page,_.value=i.itemsPerPage,i.sortBy&&i.sortBy.length>0&&c.setSorting(i.sortBy[0].key,i.sortBy[0].order),d()};K([V,b],()=>{u.value=1,d()}),H(async()=>{await d(),await ce()});const ce=async()=>{const i=await p.getAllApplicationStatuses();a.value=i.data};return(i,m)=>{const N=pe,ue=de;return f(),T(I,{title:"Application Activity Log",class:"mt-5"},{default:e(()=>[t(k,null,{default:e(()=>[r("div",ye,[r("div",Ae,[t(N,{modelValue:_.value,"onUpdate:modelValue":[m[0]||(m[0]=l=>_.value=l),m[1]||(m[1]=l=>_.value=parseInt(l,10))],items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"}},null,8,["modelValue"])])])]),_:1}),t(_e),t(ve,{"items-per-page":_.value,"onUpdate:itemsPerPage":m[3]||(m[3]=l=>_.value=l),page:u.value,"onUpdate:page":m[4]||(m[4]=l=>u.value=l),items:n.value,"items-length":x.value,headers:A,loading:y.value,class:"text-no-wrap","onUpdate:options":re},{"item.description":e(({item:l})=>[t(F,{color:C(l.description),size:"small"},{default:e(()=>[s(v(E(fe)(l.description)),1)]),_:2},1032,["color"])]),"item.user":e(({item:l})=>[s(v(l.user),1)]),"item.created_at":e(({item:l})=>[s(v(E(R)(new Date(l.created_at),"dd MMM yyyy HH:mm:ss")),1)]),"item.ip_address":e(({item:l})=>[s(v(l.properties.ip),1)]),"item.details":e(({item:l})=>[l.description==="application_status_update"?(f(),O(S,{key:0},[s(" Updated "+v(l.properties.old_status)+" to "+v(l.properties.new_status)+" ",1),Ce,l.properties.comment?(f(),O("span",we," Comment: "+v(l.properties.comment),1)):ge("",!0)],64)):l.description==="comment_added"?(f(),O(S,{key:1},[s(v(l.properties.comment),1)],64)):l.description==="university_communication_added"?(f(),O(S,{key:2},[s(" Subject: "+v(l.properties.subject),1)],64)):(f(),O(S,{key:3},[s(v(l.properties.details||"N/A"),1)],64))]),bottom:e(()=>[t(ue,{page:u.value,"onUpdate:page":m[2]||(m[2]=l=>u.value=l),"items-per-page":_.value,"total-items":x.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","items","items-length","loading"])]),_:1})}}},he={class:"comment-section"},be={class:"text-caption"},xe=["innerHTML"],st={__name:"AcoAoCommunication",props:{applicationId:{type:String,required:!0}},setup(w){const h=w,c=j(),n=g(!1),y=g(""),x=g([]),u=g(!1),_=async()=>{try{u.value=!0,await c.addAcoAoCommunication(h.applicationId,y.value),y.value="",n.value=!1,await V()}catch(A){console.error("Error adding ACO & AO communication:",A)}finally{u.value=!1}},V=async()=>{await c.getAcoAoCommunications(h.applicationId),x.value=c.acoAoCommunications},b=A=>new Date(A).toLocaleDateString();return H(V),(A,d)=>(f(),O(S,null,[t(D,null,{default:e(()=>[t(L,{cols:"12",class:"d-flex justify-end mb-4"},{default:e(()=>[t(B,{color:"primary",onClick:d[0]||(d[0]=p=>n.value=!0)},{default:e(()=>[t(z,{start:"",icon:"mdi-plus"}),s(" Add New Communication ")]),_:1})]),_:1}),t(L,{cols:"12"},{default:e(()=>[t(I,null,{default:e(()=>[t($,{class:"text-h6 font-weight-bold pa-4"},{default:e(()=>[s(" ACO & AO Communications ")]),_:1}),t(k,null,{default:e(()=>[r("div",he,[t(X,{density:A.dense},{default:e(()=>[(f(!0),O(S,null,q(x.value,(p,a)=>(f(),T(Z,{key:a,"dot-color":"primary",size:"small"},{opposite:e(()=>[r("div",be,v(b(p.created_at)),1)]),default:e(()=>[t(I,{class:"elevation-1"},{default:e(()=>[t($,{class:"text-subtitle-1"},{default:e(()=>[s(v(p.user.full_name),1)]),_:2},1024),t(k,null,{default:e(()=>[r("div",{innerHTML:p.message},null,8,xe)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["density"])])]),_:1})]),_:1})]),_:1})]),_:1}),t(oe,{modelValue:n.value,"onUpdate:modelValue":d[3]||(d[3]=p=>n.value=p),"max-width":"500px"},{default:e(()=>[t(I,null,{default:e(()=>[t($,{class:"text-h6 font-weight-bold pa-4"},{default:e(()=>[s("Add a New ACO & AO Communication")]),_:1}),t(k,null,{default:e(()=>[t(ee,{onSubmit:Q(_,["prevent"])},{default:e(()=>[t(te,{class:"text-body-1 font-weight-medium mb-2"},{default:e(()=>[s(" Message ")]),_:1}),t(E(G),{content:y.value,"onUpdate:content":d[1]||(d[1]=p=>y.value=p),theme:"snow","content-type":"html",class:"mt-2"},null,8,["content"])]),_:1})]),_:1}),t(Y,{class:"pa-4"},{default:e(()=>[t(ae),t(B,{color:"primary",loading:u.value,disabled:u.value,onClick:_},{default:e(()=>[t(z,{start:"",icon:"mdi-send"}),s(" Submit Communication ")]),_:1},8,["loading","disabled"]),t(B,{color:"secondary",disabled:u.value,onClick:d[2]||(d[2]=p=>n.value=!1)},{default:e(()=>[s(" Cancel ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},Oe={class:"comment-section"},Ve={class:"text-caption"},Se=["innerHTML"],lt={__name:"AcoCoCommunication",props:{applicationId:{type:String,required:!0}},setup(w){const h=w,c=j(),n=g(!1),y=g(""),x=g([]),u=g(!1),_=async()=>{try{u.value=!0,await c.addAcoCoCommunication(h.applicationId,y.value),y.value="",n.value=!1,await V()}catch(A){console.error("Error adding ACO & CO communication:",A)}finally{u.value=!1}},V=async()=>{await c.getAcoCoCommunications(h.applicationId),x.value=c.acoCoCommunications},b=A=>new Date(A).toLocaleDateString();return H(V),(A,d)=>(f(),O(S,null,[t(D,null,{default:e(()=>[t(L,{cols:"12",class:"d-flex justify-end mb-4"},{default:e(()=>[t(B,{color:"primary",onClick:d[0]||(d[0]=p=>n.value=!0)},{default:e(()=>[t(z,{start:"",icon:"mdi-plus"}),s(" Add New Communication ")]),_:1})]),_:1}),t(L,{cols:"12"},{default:e(()=>[t(I,null,{default:e(()=>[t($,{class:"text-h6 font-weight-bold pa-4"},{default:e(()=>[s(" ACO & CO Communications ")]),_:1}),t(k,null,{default:e(()=>[r("div",Oe,[t(X,{density:A.dense},{default:e(()=>[(f(!0),O(S,null,q(x.value,(p,a)=>(f(),T(Z,{key:a,"dot-color":"primary",size:"small"},{opposite:e(()=>[r("div",Ve,v(b(p.created_at)),1)]),default:e(()=>[t(I,{class:"elevation-1"},{default:e(()=>[t($,{class:"text-subtitle-1"},{default:e(()=>[s(v(p.user.full_name),1)]),_:2},1024),t(k,null,{default:e(()=>[r("div",{innerHTML:p.message},null,8,Se)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["density"])])]),_:1})]),_:1})]),_:1})]),_:1}),t(oe,{modelValue:n.value,"onUpdate:modelValue":d[3]||(d[3]=p=>n.value=p),"max-width":"500px"},{default:e(()=>[t(I,null,{default:e(()=>[t($,{class:"text-h6 font-weight-bold pa-4"},{default:e(()=>[s("Add a New ACO & CO Communication")]),_:1}),t(k,null,{default:e(()=>[t(ee,{onSubmit:Q(_,["prevent"])},{default:e(()=>[t(te,{class:"text-body-1 font-weight-medium mb-2"},{default:e(()=>[s(" Message ")]),_:1}),t(E(G),{content:y.value,"onUpdate:content":d[1]||(d[1]=p=>y.value=p),theme:"snow","content-type":"html",class:"mt-2"},null,8,["content"])]),_:1})]),_:1}),t(Y,{class:"pa-4"},{default:e(()=>[t(ae),t(B,{color:"primary",loading:u.value,disabled:u.value,onClick:_},{default:e(()=>[t(z,{start:"",icon:"mdi-send"}),s(" Submit Communication ")]),_:1},8,["loading","disabled"]),t(B,{color:"secondary",disabled:u.value,onClick:d[2]||(d[2]=p=>n.value=!1)},{default:e(()=>[s(" Cancel ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},Le=w=>(J("data-v-eca9312f"),w=w(),W(),w),ke=Le(()=>r("thead",null,[r("tr",null,[r("th",null,"Name"),r("th",null,"Email"),r("th",null,"Status")])],-1)),Ie={__name:"ApplicationOfficerAssignments",props:{applicationId:{type:String,required:!0}},setup(w){const h=w,c=j(),n=g(null),y=g(""),x=P(()=>c.applicationOfficerOptions),u=P(()=>c.applicationOfficers),_=P(()=>{if(!y.value)return u.value;const a=y.value.toLowerCase();return u.value.filter(o=>o.full_name.toLowerCase().includes(a)||o.email.toLowerCase().includes(a)||o.pivot.status.toLowerCase().includes(a))}),V=async()=>{try{if(!n.value){errorMessage.value="Please select an officer before assigning.";return}if((await M.fire({title:"Confirm Assignment",text:"Are you sure you want to assign this application officer?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, assign it!"})).isConfirmed){const o=await c.assignApplicationOfficer(h.applicationId,n.value);if(o&&!o.status)throw console.log("hello"),console.log(o),new Error(o);M.fire({icon:"success",title:"Assignment Successful",text:"You have assigned the application officer successfully!",confirmButtonText:"OK"}),n.value=null,await b()}}catch(a){console.log(a),M.fire({icon:"error",title:"Assignment Failed",text:a,confirmButtonText:"OK"})}},b=async()=>{await c.fetchApplicationOfficers(h.applicationId)};H(async()=>{await Promise.all([b(),c.loadAllApplicationOfficers()])}),K(()=>h.applicationId,b);const A=a=>({accepted:"success",rejected:"error",pending:"warning"})[a.toLowerCase()]||"secondary",d=a=>({accepted:"Accepted",rejected:"Rejected",pending:"Pending"})[a.toLowerCase()]||a,p=a=>({success:"white",error:"white",warning:"black",secondary:"white"})[a]||"white";return(a,o)=>{const U=se;return f(),T(I,null,{default:e(()=>[t($,null,{default:e(()=>[s("Application Officer Assignments")]),_:1}),t(k,null,{default:e(()=>[t(D,null,{default:e(()=>[t(L,{cols:"12",md:"6"},{default:e(()=>[t(U,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=C=>n.value=C),items:x.value,"item-title":"full_name","item-value":"id",label:"Select Application Officer",placeholder:"Search and select an officer",clearable:""},null,8,["modelValue","items"])]),_:1}),t(L,{cols:"12",md:"6",class:"d-flex align-center"},{default:e(()=>[t(B,{class:"mt-6",color:"primary",disabled:!n.value,onClick:V},{default:e(()=>[s(" Assign Officer ")]),_:1},8,["disabled"])]),_:1})]),_:1}),t(D,{class:"mt-4"},{default:e(()=>[t(L,{cols:"12"},{default:e(()=>[_.value.length?(f(),T(ne,{key:0},{default:e(()=>[ke,r("tbody",null,[(f(!0),O(S,null,q(_.value,C=>(f(),O("tr",{key:C.id},[r("td",null,v(C.user.full_name),1),r("td",null,v(C.user.email),1),r("td",null,[t(F,{color:A(C.status),"text-color":p(A(C.status)),size:"small",label:""},{default:e(()=>[s(v(d(C.status)),1)]),_:2},1032,["color","text-color"])])]))),128))])]),_:1})):(f(),T(ie,{key:1,type:"info",class:"mt-2"},{default:e(()=>[s(" No assigned officers found. ")]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1})}}},nt=le(Ie,[["__scopeId","data-v-eca9312f"]]),Te=w=>(J("data-v-aa458ed5"),w=w(),W(),w),$e=Te(()=>r("thead",null,[r("tr",null,[r("th",null,"Name"),r("th",null,"Email"),r("th",null,"Status")])],-1)),Be={__name:"ComplianceOfficerAssignments",props:{applicationId:{type:String,required:!0}},setup(w){const h=w,c=j(),n=g(null),y=g(""),x=P(()=>c.complianceOfficerOptions),u=P(()=>c.complianceOfficers),_=P(()=>{if(!y.value)return u.value;const a=y.value.toLowerCase();return u.value.filter(o=>o.full_name.toLowerCase().includes(a)||o.email.toLowerCase().includes(a)||o.pivot.status.toLowerCase().includes(a))}),V=async()=>{try{if(!n.value){errorMessage.value="Please select an officer before assigning.";return}if((await M.fire({title:"Confirm Assignment",text:"Are you sure you want to assign this compliance officer?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, assign it!"})).isConfirmed){const o=await c.assignComplianceOfficer(h.applicationId,n.value);if(o&&!o.status)throw new Error(o);M.fire({icon:"success",title:"Assignment Successful",text:"You have assigned the compliance officer successfully!",confirmButtonText:"OK"}),n.value=null,await b()}}catch(a){console.log(a),M.fire({icon:"error",title:"Assignment Failed",text:a,confirmButtonText:"OK"})}},b=async()=>{await c.fetchComplianceOfficers(h.applicationId)};H(async()=>{await Promise.all([b(),c.loadAllComplianceOfficers()])}),K(()=>h.applicationId,b);const A=a=>({accepted:"success",rejected:"error",pending:"warning"})[a.toLowerCase()]||"secondary",d=a=>({accepted:"Accepted",rejected:"Rejected",pending:"Pending"})[a.toLowerCase()]||a,p=a=>({success:"white",error:"white",warning:"black",secondary:"white"})[a]||"white";return(a,o)=>{const U=se;return f(),T(I,null,{default:e(()=>[t($,null,{default:e(()=>[s("Compliance Officer Assignments")]),_:1}),t(k,null,{default:e(()=>[t(D,null,{default:e(()=>[t(L,{cols:"12",md:"6"},{default:e(()=>[t(U,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=C=>n.value=C),items:x.value,"item-title":"full_name","item-value":"id",label:"Select Compliance Officer",placeholder:"Search and select an officer",clearable:""},null,8,["modelValue","items"])]),_:1}),t(L,{cols:"12",md:"6",class:"d-flex align-center"},{default:e(()=>[t(B,{class:"mt-6",color:"primary",disabled:!n.value,onClick:V},{default:e(()=>[s(" Assign Officer ")]),_:1},8,["disabled"])]),_:1})]),_:1}),t(D,{class:"mt-4"},{default:e(()=>[t(L,{cols:"12"},{default:e(()=>[_.value.length?(f(),T(ne,{key:0},{default:e(()=>[$e,r("tbody",null,[(f(!0),O(S,null,q(_.value,C=>(f(),O("tr",{key:C.id},[r("td",null,v(C.user.full_name),1),r("td",null,v(C.user.email),1),r("td",null,[t(F,{color:A(C.status),"text-color":p(A(C.status)),size:"small",label:""},{default:e(()=>[s(v(d(C.status)),1)]),_:2},1032,["color","text-color"])])]))),128))])]),_:1})):(f(),T(ie,{key:1,type:"info",class:"mt-2"},{default:e(()=>[s(" No assigned officers found. ")]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1})}}},it=le(Be,[["__scopeId","data-v-aa458ed5"]]);export{nt as A,it as C,st as _,ot as a,lt as b};
