import{_ as P}from"./AppAutocomplete-BGkQfw1O.js";import{_ as A}from"./Filters-D5EbE5TN.js";import{c as M}from"./commonFunction-BbLKMbdF.js";import{u as R}from"./leadStore-Cb9i-gIv.js";import{i as r}from"./index-D7qR2wUX.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as z}from"./VCard-CP0oKkAP.js";import{V as v,a as y}from"./VRow-BMY6kRyU.js";import{r as d,H as O,o as p,f as _,e as t,z as c,b as a,a9 as S,a2 as $,d as g,c as B,n as x,F,y as G,v as k,x as H,R as J,U as K}from"./main-Bzi-in0m.js";import{V as Q}from"./VFileInput-B6SAbWqy.js";import{V as W}from"./VCardText-BrDdHSiy.js";import"./VInput-ry-gLANT.js";import"./index-DYipBynw.js";import"./index-psnl6eYY.js";import"./forwardRefs-D3j0TLhE.js";import"./VSelect-BSsmmx_v.js";import"./VTextField-Dgv4ZvmK.js";import"./VList-D6Y46Ct5.js";import"./ssrBoot-DyIZ1z-Z.js";import"./VAvatar-Dc-Pcn2C.js";import"./VImg-4NSskl6O.js";import"./VDivider-CSwFFDml.js";import"./dialog-transition-83Nj8A-a.js";import"./scopeId-BYlfWzXQ.js";import"./VMenu-1reUhpVn.js";import"./VCheckboxBtn-B4COaLs2.js";import"./VChip-BC31xMLF.js";import"./filter-C_ByeHyW.js";import"./AppDateTimePicker-BpBEe_Fb.js";import"./AppSelect-BkCjTa-J.js";import"./AppTextField-CWAboqRr.js";import"./rolePermission-C3D7BUuX.js";import"./helpers-BT33bd1P.js";import"./user-Cz8v8JFZ.js";/* empty css              */const U=n=>(J("data-v-dcae0371"),n=n(),K(),n),X=U(()=>g("span",{class:"text-h6 upload-title"},"Upload Lead Excel/csv File",-1)),Y={class:"form-padding mt-6 upload-form"},Z=U(()=>g("p",{class:"text-caption text-primary"},"Only Excel/CSV file support",-1)),ee=U(()=>g("span",{class:"font-weight-bold"},"Download Sample Excel/CSV File",-1)),le={__name:"upload-lead",props:{showUploadCard:Boolean},emits:["update:showUploadCard","leadsUploaded"],setup(n,{emit:E}){const L=n,C=E,I=R(),u=M(),m=d(null),s=d(null),o=d(null),V=d(null),f=d(!1),i=d(null);O(async()=>{await u.getAllCountries(),await u.getBranches()});const T=()=>{C("update:showUploadCard",!L.showUploadCard)},D=()=>{window.open("https://channel-partner-panel.ams3.cdn.digitaloceanspaces.com/SGE%20CRM%20Upload%20Format.xlsx","_blank")},j=b=>{i.value=b.target.files[0]},N=async()=>{if(!i.value){r.error("Please select a file to upload",{position:"top-right",theme:"colored"});return}if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(i.value.type)){r.error("Please upload only Excel or CSV files",{position:"top-right",theme:"colored"});return}if(o.value!=="event"&&!m.value){r.error("Please select a Country",{position:"top-right",theme:"colored"});return}if(!s.value){r.error("Please select a Branch",{position:"top-right",theme:"colored"});return}f.value=!0;try{const e=new FormData;e.append("file",i.value),e.append("assigned_branch",s.value),e.append("lead_country_id",m.value||""),e.append("lead_type",o.value||""),e.append("lead_event_id",V.value||""),await I.uploadLeads(e),s.value=null,m.value=null,document.querySelector('input[type="file"]')&&(document.querySelector('input[type="file"]').value=""),i.value=null,C("update:showUploadCard",!1),C("leadsUploaded"),r.success("File uploaded successfully!",{position:"top-right",theme:"colored"})}catch(e){const h=(e==null?void 0:e.message)||"Some records contain empty values.";r.error(h,{position:"top-right",theme:"colored"})}finally{f.value=!1}};return(b,e)=>{const h=A,w=P;return n.showUploadCard?(p(),_(z,{key:0,class:"mt-4 w-100 full-width-card upload-card"},{default:t(()=>[a(W,null,{default:t(()=>[a(v,{justify:"space-between",class:"align-center"},{default:t(()=>[X,a(S,{color:"error",icon:"",onClick:T,class:"close-btn"},{default:t(()=>[a($,{icon:"tabler-x"})]),_:1})]),_:1}),g("div",Y,[a(v,{class:"mb-4 fade-in"},{default:t(()=>[a(h,{"selected-lead-type":o.value,onUpdateLeadType:e[0]||(e[0]=l=>o.value=l),"country-label":"Lead Country","branch-label":"Lead Branch (Optional)"},null,8,["selected-lead-type"]),o.value==="social"?(p(),B(F,{key:0},[a(y,{cols:"12",md:"4"},{default:t(()=>[a(w,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),items:x(u).allCountries,"item-title":l=>l.name,"item-value":l=>l.id,label:"Select Country",placeholder:"Select Country",clearable:"",class:"slide-in"},null,8,["modelValue","items","item-title","item-value"])]),_:1}),a(y,{cols:"12",md:"4"},{default:t(()=>[a(w,{modelValue:s.value,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value=l),items:x(u).branches,"item-title":l=>l.name,"item-value":l=>l.id,label:"Select Branch",placeholder:"Select Branch",clearable:"",class:"slide-in"},null,8,["modelValue","items","item-title","item-value"])]),_:1})],64)):c("",!0),o.value==="event"?(p(),B(F,{key:1},[a(h,{"selected-event":V.value,onUpdateEvent:e[3]||(e[3]=l=>V.value=l)},null,8,["selected-event"]),a(y,{cols:"12",md:"4"},{default:t(()=>[a(w,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value=l),items:x(u).branches,"item-title":l=>l.name,"item-value":l=>l.id,label:"Select Branch",placeholder:"Select Branch",clearable:"",class:"slide-in"},null,8,["modelValue","items","item-title","item-value"])]),_:1})],64)):c("",!0)]),_:1}),o.value?(p(),_(v,{key:0,justify:"center",align:"center",class:"gap-4 fade-in"},{default:t(()=>[a(y,{cols:"12",md:"6"},{default:t(()=>[a(Q,{accept:".xlsx, .csv",label:"Upload Excel/CSV file",onChange:j,variant:"outlined",color:"purple-lighten-4",class:G(["file-input-animate",{"has-file":i.value}])},null,8,["class"])]),_:1}),a(S,{"prepend-icon":"tabler-cloud-upload",onClick:N,color:"purple-lighten-4",class:"upload-btn",loading:f.value,disabled:f.value},{default:t(()=>[k(H(f.value?"Uploading...":"Upload"),1)]),_:1},8,["loading","disabled"])]),_:1})):c("",!0),o.value?(p(),_(v,{key:1,justify:"center",class:"mt-2 fade-in"},{default:t(()=>[Z]),_:1})):c("",!0),o.value?(p(),_(v,{key:2,justify:"center",align:"center",class:"mt-6 gap-2 sample-section fade-in"},{default:t(()=>[ee,a(S,{"prepend-icon":"tabler-cloud-download",onClick:D,class:"download-btn btn-small",variant:"outlined"},{default:t(()=>[k(" Download Sample ")]),_:1})]),_:1})):c("",!0)])]),_:1})]),_:1})):c("",!0)}}},Pe=q(le,[["__scopeId","data-v-dcae0371"]]);export{Pe as default};
