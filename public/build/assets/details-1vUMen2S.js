import{r as E,e as Ve}from"./validators-DzQNU67t.js";import{r as s,w as fe,o as r,c as I,b as e,e as l,a7 as X,n as V,d as a,a8 as _,v as u,F as Z,j as ge,k as be,H as ye,a as Ce,f as A,a2 as me,an as Se,z as S,x as c,i as ne,R as we,U as he}from"./main-uFLjzVgR.js";import{_ as ke,a as Ae,A as De,C as Ue,b as $e,c as Ie}from"./ComplianceOfficerAssignments-BJ7bRkLH.js";import{_ as Ne}from"./AppAutocomplete-BwMr89wg.js";import{u as Te}from"./applicationList-C3RkYbKz.js";import{_ as Fe}from"./AppDateTimePicker-BjgxKL2j.js";import{_ as Le}from"./AppTextField-CfHCspUQ.js";import{_ as je}from"./DialogCloseBtn-B-8gqOKm.js";import{u as Be}from"./submitApplication-JKtSZZ02.js";import{S as ce}from"./sweetalert2-z6gKu1nJ.js";import{V as x,b as J,c as ee}from"./VCard-CzqBpY8w.js";import{V as B}from"./VCardText-GWGE2nB0.js";import{V as le}from"./VForm-CBaewViW.js";import{V as T,a as g}from"./VRow-DJVu-vXX.js";import{V as Q}from"./VDialog-DXvFoUCr.js";import{V as ae}from"./VSpacer-B9qTCTKZ.js";/* empty css                         */import Me from"./details-document-B8niBj3Q.js";import{g as qe}from"./helpers-DR0iKWLW.js";import{_ as Oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as W,a as Ee}from"./VTextField-Cs3KkzI3.js";import{V as xe}from"./VFileInput-CarnppPy.js";import{V as He,a as D,b as Pe,c as U}from"./VWindowItem-CzgsefRe.js";import{V as pe}from"./VTable-BUFxCYcZ.js";import"./forwardRefs-D3j0TLhE.js";import"./index-TvoVXORd.js";import"./TablePagination-inFhvRrl.js";import"./VDivider-DBOFig94.js";import"./VPagination-B1MhJS1L.js";import"./AppSelect-bDj5P7oQ.js";import"./VSelect-DiLvMFjd.js";import"./VList-Ba_fpnwl.js";import"./index-DwgpItnh.js";import"./ssrBoot-8-8uwLz2.js";import"./VAvatar-BegTrGob.js";import"./VImg-gu-DwJWt.js";import"./dialog-transition-bE7zyEbW.js";import"./lazy-LylD6nIV.js";import"./scopeId-CQRjbWVD.js";import"./VMenu-CFyXDyXY.js";import"./VCheckboxBtn-Cp8E0oEZ.js";import"./VChip-B-suaY94.js";import"./VSlideGroup-njTomq8M.js";import"./format-Ce6nycQ_.js";import"./VDataTableServer-NF2Z0GsU.js";import"./VDataTable-DyjiwJu2.js";import"./filter-CplzIzX6.js";import"./VAlert-5rdFK1Cb.js";/* empty css              */import"./fileStore-tzTBpIha.js";import"./vue-filepond.esm-CWubIId7.js";const Re={class:"d-flex justify-end mt-4"},ze={__name:"StudentInfoEditDialog",props:{isDialogVisible:Boolean,first_name:String,last_name:String,email:String,passport_no:String,dob:String,id:String,refreshUpdateInfo:Function},emits:["update:isDialogVisible","refreshUpdateInfo"],setup(M,{emit:te}){const y=M,v=Be(),m=s(""),C=s(""),w=s(""),h=s(""),k=s(""),F=s(""),f=s(!1),L=s(!1);fe(()=>y.isDialogVisible,i=>{i&&(w.value=y.first_name,h.value=y.last_name,k.value=y.email,m.value=y.passport_no,C.value=y.dob,F.value=y.id)});const $=te,H=i=>{$("update:isDialogVisible",i)},q=s(null),Y=async()=>{q.value&&q.value.validate().then(i=>{i&&(f.value=!0)})},N=async()=>{L.value=!0;const i={passport_no:m.value,date_of_birth:C.value,first_name:w.value,last_name:h.value,email:k.value};try{await v.updateApplication(i,F.value),ce.fire({icon:"success",title:"Update Successful",text:"Application updated successfully!",confirmButtonText:"OK"})}catch(n){ce.fire({icon:"error",title:"Update Failed",text:n,confirmButtonText:"OK"})}finally{L.value=!1}f.value=!1,H(!1),$("refreshUpdateInfo")};return(i,n)=>{const G=je,j=Le,oe=Fe;return r(),I(Z,null,[e(Q,{"model-value":y.isDialogVisible,persistent:"",width:i.$vuetify.display.smAndDown?"auto":1200,"onUpdate:modelValue":H},{default:l(()=>[e(G,{onClick:n[0]||(n[0]=p=>i.$emit("update:isDialogVisible",!1))}),e(x,{class:"pricing-dialog pa-2 pa-sm-10"},{default:l(()=>[e(B,null,{default:l(()=>[e(le,{ref_key:"refForm",ref:q,class:"form-padding",onSubmit:X(p=>({}),["prevent"])},{default:l(()=>[e(T,null,{default:l(()=>[e(g,{cols:"12",md:"12"},{default:l(()=>[e(T,null,{default:l(()=>[e(g,{cols:"12",md:"6"},{default:l(()=>[e(j,{modelValue:w.value,"onUpdate:modelValue":n[1]||(n[1]=p=>w.value=p),label:"Student First Name",placeholder:"John",rules:["requiredValidator"in i?i.requiredValidator:V(E)]},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",md:"6"},{default:l(()=>[e(j,{modelValue:h.value,"onUpdate:modelValue":n[2]||(n[2]=p=>h.value=p),label:"Student Last Name",placeholder:"Doe",rules:["requiredValidator"in i?i.requiredValidator:V(E)]},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(g,{cols:"12",md:"6"},{default:l(()=>[e(j,{modelValue:m.value,"onUpdate:modelValue":n[3]||(n[3]=p=>m.value=p),label:"Student Passport No.",placeholder:"A099800",rules:["requiredValidator"in i?i.requiredValidator:V(E)]},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",md:"6"},{default:l(()=>[e(oe,{modelValue:C.value,"onUpdate:modelValue":n[4]||(n[4]=p=>C.value=p),label:"Date of birth",placeholder:"Select date",rules:["requiredValidator"in i?i.requiredValidator:V(E)]},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(g,{cols:"12",md:"6"},{default:l(()=>[e(j,{modelValue:k.value,"onUpdate:modelValue":n[5]||(n[5]=p=>k.value=p),label:"Enter Student E-Mail ID",placeholder:"student@example.com",type:"email",rules:["requiredValidator"in i?i.requiredValidator:V(E),"emailValidator"in i?i.emailValidator:V(Ve)]},null,8,["modelValue","rules"])]),_:1})]),_:1}),a("div",Re,[e(_,{color:"primary",onClick:Y},{default:l(()=>[u(" Update ")]),_:1})])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["model-value","width"]),e(Q,{modelValue:f.value,"onUpdate:modelValue":n[7]||(n[7]=p=>f.value=p),"max-width":"500"},{default:l(()=>[e(x,null,{default:l(()=>[e(J,{class:"text-h5"},{default:l(()=>[u(" Confirm Submission ")]),_:1}),e(B,null,{default:l(()=>[u("Are you sure you want to update the information?")]),_:1}),e(ee,null,{default:l(()=>[e(ae),e(_,{color:"primary",onClick:N},{default:l(()=>[u(" Yes ")]),_:1}),e(_,{color:"secondary",onClick:n[6]||(n[6]=p=>f.value=!1)},{default:l(()=>[u(" No ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},b=M=>(we("data-v-e5f01468"),M=M(),he(),M),Ke=b(()=>a("div",null,"Application Details",-1)),We={class:"icon-right"},Je=b(()=>a("td",null,[a("strong",null,"Application Id")],-1)),Qe=b(()=>a("td",null,[a("strong",null,"Date Added")],-1)),Ye=b(()=>a("td",null,[a("strong",null,"Student ID")],-1)),Ge=b(()=>a("td",null,[a("strong",null,"Student Passport No.")],-1)),Xe=b(()=>a("td",null,[a("strong",null,"Student Name")],-1)),Ze=b(()=>a("td",null,[a("strong",null,"Student Date of Birth")],-1)),el=b(()=>a("td",null,[a("strong",null,"Student E-Mail")],-1)),ll=b(()=>a("td",null,[a("strong",null,"Student Phone No.")],-1)),al=b(()=>a("td",null,[a("strong",null,"Communication E-Mail ID")],-1)),tl=b(()=>a("td",null,[a("strong",null,"Communication Phone No.")],-1)),ol=b(()=>a("thead",null,[a("tr",null,[a("th",null,"Date Added"),a("th",null,"Comment"),a("th",null,"Status and Document")])],-1)),nl=["innerHTML"],ul={key:0,class:"current-status-label"},sl={key:1},il=["href"],dl={class:"comment-section"},rl={class:"comment-header"},ml={class:"comment-date"},cl=["innerHTML"],pl={class:"comment-section"},fl={class:"comment-header"},vl={class:"comment-date"},_l={class:"communication-subject"},Vl=b(()=>a("strong",null,"Subject:",-1)),gl={class:"comment-body"},bl=["innerHTML"],yl={__name:"details",setup(M){const te=s(qe()==="admin"),y=ge(),v=y.params.id;console.log(v);const m=Te(),C=s("student-course-details"),w=s(!1),h=s(!1),k=s(!1),F=s(""),f=s(""),L=s(!1),$=s({subject:"",message:""});s([{name:"Document1.pdf",progress:100},{name:"Document2.pdf",progress:100},{name:"Document3.pdf",progress:100},{name:"Document4.pdf",progress:100}]);const H=s([]),q=s([]),Y=s([{created_at:"",comment:"",status_text:""}]),N=s({application_id:"",created_at:"",counsellor_email:"",counsellor_number:""}),i=s();s(!0);const n=s({id:null,student_id:null,first_name:null,last_name:null,passport_no:null,date_of_birth:null,whatsapp_number:null,email:null,address:null,city:null,country:null,region:null,state:null,gender:null,visa_refusal:null,created_at:null,updated_at:null,document:[{id:null,student_id:null,path:null,created_at:null,updated_at:null}]}),G=s([]),j=s([]),oe=be(),p=()=>{oe.back()},ue=()=>{const d=y.hash.replace("#","");d&&(C.value=d)};fe(()=>y.hash,ue),ye(()=>{ue(),P()});const P=async()=>{await m.getApplicationDetails(v),await m.getApplicationStatusses(v),await m.getApplicationAllStatuses(),N.value=m.applicationData,G.value=m.documents,n.value=m.students,Y.value=m.statuses,H.value=m.comments,q.value=m.universityCommunications,j.value=m.allStatuses.filter(d=>d.id!==N.value.status),console.log(n)},R=s(!1),z=s(!1),K=s(!1),se=async()=>{try{R.value=!0;let d=new FormData;d.append("status",F.value),d.append("comment",f.value),i.value&&d.append("file",i.value[0]),await m.updateStatus(v,d),w.value=!1,F.value="",f.value="",i.value=null,await P()}catch(d){console.error("Error updating status:",d)}finally{R.value=!1}},ie=async()=>{try{z.value=!0,await m.addComment(v,f.value),f.value="",h.value=!1,await P()}catch(d){console.error("Error adding comment:",d)}finally{z.value=!1}},de=async()=>{try{K.value=!0,await m.addUniversityCommunication(v,$.value),$.value={subject:"",message:""},k.value=!1,await P()}catch(d){console.error("Error adding university communication:",d)}finally{K.value=!1}};return(d,o)=>{const ve=Ne,re=Ie,_e=Ce("IconBtn");return r(),A(x,null,{default:l(()=>[e(J,{class:"d-flex justify-space-between align-center"},{default:l(()=>[Ke,e(_,{color:"primary",onClick:p},{default:l(()=>[e(me,{icon:"tabler-arrow-left",class:"mr-2"}),u(" Back ")]),_:1})]),_:1}),e(B,null,{default:l(()=>[e(Q,{modelValue:w.value,"onUpdate:modelValue":o[4]||(o[4]=t=>w.value=t),"max-width":"500px"},{default:l(()=>[e(x,null,{default:l(()=>[e(J,null,{default:l(()=>[u("Change Current Status")]),_:1}),e(B,null,{default:l(()=>[e(le,{onSubmit:X(se,["prevent"])},{default:l(()=>[e(ve,{modelValue:F.value,"onUpdate:modelValue":o[0]||(o[0]=t=>F.value=t),items:j.value,"item-title":t=>t.name,"item-value":t=>t.id,label:"Status",placeholder:"Select Status",rules:["requiredValidator"in d?d.requiredValidator:V(E)]},null,8,["modelValue","items","item-title","item-value","rules"]),e(W,{class:"mt-2"},{default:l(()=>[u(" Add any necessary file (Optional) ")]),_:1}),e(xe,{modelValue:i.value,"onUpdate:modelValue":o[1]||(o[1]=t=>i.value=t),color:"primary",label:"File input",variant:"outlined",class:"mt-2"},null,8,["modelValue"]),e(W,{class:"mt-2"},{default:l(()=>[u(" Comment (Optional) ")]),_:1}),e(re,{modelValue:f.value,"onUpdate:modelValue":o[2]||(o[2]=t=>f.value=t),placeholder:"Place any comment regarding status"},null,8,["modelValue"])]),_:1})]),_:1}),e(ee,null,{default:l(()=>[e(ae),e(_,{color:"primary",loading:R.value,disabled:R.value,onClick:se},{default:l(()=>[u(" Submit ")]),_:1},8,["loading","disabled"]),e(_,{disabled:R.value,onClick:o[3]||(o[3]=t=>w.value=!1)},{default:l(()=>[u(" Cancel ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Q,{modelValue:h.value,"onUpdate:modelValue":o[7]||(o[7]=t=>h.value=t),"max-width":"500px"},{default:l(()=>[e(x,null,{default:l(()=>[e(J,null,{default:l(()=>[u("Add a New Comment")]),_:1}),e(B,null,{default:l(()=>[e(le,{onSubmit:X(ie,["prevent"])},{default:l(()=>[e(W,{class:"mt-2"},{default:l(()=>[u(" New Comment ")]),_:1}),e(re,{modelValue:f.value,"onUpdate:modelValue":o[5]||(o[5]=t=>f.value=t),placeholder:"Add a new comment",class:"mt-2"},null,8,["modelValue"])]),_:1})]),_:1}),e(ee,null,{default:l(()=>[e(ae),e(_,{color:"primary",loading:z.value,disabled:z.value,onClick:ie},{default:l(()=>[u(" Submit Comment ")]),_:1},8,["loading","disabled"]),e(_,{disabled:z.value,onClick:o[6]||(o[6]=t=>h.value=!1)},{default:l(()=>[u(" Cancel ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Q,{modelValue:k.value,"onUpdate:modelValue":o[11]||(o[11]=t=>k.value=t),"max-width":"500px"},{default:l(()=>[e(x,null,{default:l(()=>[e(J,null,{default:l(()=>[u("Add a New University Communication")]),_:1}),e(B,null,{default:l(()=>[e(le,{onSubmit:X(de,["prevent"])},{default:l(()=>[e(W,{class:"mt-2"},{default:l(()=>[u(" Subject ")]),_:1}),e(Ee,{modelValue:$.value.subject,"onUpdate:modelValue":o[8]||(o[8]=t=>$.value.subject=t),placeholder:"Subject",class:"mt-2"},null,8,["modelValue"]),e(W,{class:"mt-2"},{default:l(()=>[u(" Message ")]),_:1}),e(V(Se),{content:$.value.message,"onUpdate:content":o[9]||(o[9]=t=>$.value.message=t),theme:"snow","content-type":"html",class:"mt-2"},null,8,["content"])]),_:1})]),_:1}),e(ee,null,{default:l(()=>[e(ae),e(_,{color:"primary",loading:K.value,disabled:K.value,onClick:de},{default:l(()=>[u(" Submit Communication ")]),_:1},8,["loading","disabled"]),e(_,{disabled:K.value,onClick:o[10]||(o[10]=t=>k.value=!1)},{default:l(()=>[u(" Cancel ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(He,{modelValue:C.value,"onUpdate:modelValue":o[12]||(o[12]=t=>C.value=t)},{default:l(()=>[e(D,{value:"student-course-details"},{default:l(()=>[u(" Student/Course Details ")]),_:1}),e(D,{value:"upload-download"},{default:l(()=>[u(" Upload/Download ")]),_:1}),e(D,{value:"status"},{default:l(()=>[u(" Status ")]),_:1}),e(D,{value:"comments"},{default:l(()=>[u(" Comments ")]),_:1}),e(D,{value:"university-communication"},{default:l(()=>[u(" University Communication ")]),_:1}),d.$can("enable","aco-ao-communication")?(r(),A(D,{key:0,value:"aco-ao-communication"},{default:l(()=>[u(" ACO & AO Communication ")]),_:1})):S("",!0),d.$can("assign","application-officer")?(r(),A(D,{key:1,value:"assign-officer"},{default:l(()=>[u(" Assign Application Officer ")]),_:1})):S("",!0),d.$can("assign","compliance-officer")?(r(),A(D,{key:2,value:"assign-compliance-officer"},{default:l(()=>[u("Assign Compliance Officer ")]),_:1})):S("",!0),d.$can("enable","aco-co-communication")?(r(),A(D,{key:3,value:"aco-co-communication"},{default:l(()=>[u("ACO & CO Communication")]),_:1})):S("",!0),te.value?(r(),A(D,{key:4,value:"activity-logs"},{default:l(()=>[u(" Activity Logs ")]),_:1})):S("",!0)]),_:1},8,["modelValue"]),e(B,null,{default:l(()=>[e(Pe,{modelValue:C.value,"onUpdate:modelValue":o[18]||(o[18]=t=>C.value=t)},{default:l(()=>[e(U,{value:"student-course-details"},{default:l(()=>[a("div",We,[e(_e,{onClick:o[13]||(o[13]=t=>L.value=!L.value)},{default:l(()=>[e(me,{icon:"tabler-edit"})]),_:1}),e(ze,{"is-dialog-visible":L.value,"onUpdate:isDialogVisible":o[14]||(o[14]=t=>L.value=t),first_name:n.value.first_name,last_name:n.value.last_name,email:n.value.email,passport_no:n.value.passport_no,dob:n.value.date_of_birth,id:n.value.id,onRefreshUpdateInfo:P},null,8,["is-dialog-visible","first_name","last_name","email","passport_no","dob","id"])]),e(T,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(pe,null,{default:l(()=>[a("tbody",null,[a("tr",null,[Je,a("td",null,c(N.value.application_id),1),Qe,a("td",null,c(N.value.created_at),1)]),a("tr",null,[Ye,a("td",null,c(n.value.student_id??""),1),Ge,a("td",null,c(n.value.passport_no),1)]),a("tr",null,[Xe,a("td",null,c(n.value.first_name)+" "+c(n.value.last_name),1),Ze,a("td",null,c(n.value.date_of_birth),1)]),a("tr",null,[el,a("td",null,c(n.value.email),1),ll,a("td",null,c(n.value.whatsapp_number),1)]),a("tr",null,[al,a("td",null,c(N.value.counsellor_email),1),tl,a("td",null,c(N.value.counsellor_number),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),e(U,{value:"upload-download"},{default:l(()=>[e(Me,{"existing-documents":G.value,"zip-link":n.value.document_zip_link},null,8,["existing-documents","zip-link"])]),_:1}),e(U,{value:"status"},{default:l(()=>[e(T,null,{default:l(()=>[e(g,{cols:"12",class:"d-flex justify-end"},{default:l(()=>[C.value==="status"&&d.$can("status","application")?(r(),A(_,{key:0,color:"primary",onClick:o[15]||(o[15]=t=>w.value=!0)},{default:l(()=>[u(" Change Current Status ")]),_:1})):S("",!0)]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(pe,null,{default:l(()=>[ol,a("tbody",null,[(r(!0),I(Z,null,ne(Y.value,(t,O)=>(r(),I("tr",{key:O},[a("td",null,c(t.created_at),1),a("td",null,c(t.comment),1),a("td",null,[a("div",null,[a("span",{innerHTML:t.status_text},null,8,nl),O===0?(r(),I("span",ul,"(Current Status)")):S("",!0),t.document?(r(),I("div",sl,[a("div",null,c(t.file_name),1),a("a",{href:t.document,target:"_blank",class:"download-link"},"Document",8,il)])):S("",!0)])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),e(U,{value:"comments"},{default:l(()=>[e(T,null,{default:l(()=>[e(g,{cols:"12",class:"d-flex justify-end"},{default:l(()=>[d.$can("comment","application")?(r(),A(_,{key:0,color:"primary",onClick:o[16]||(o[16]=t=>h.value=!0)},{default:l(()=>[u(" Add New Comment ")]),_:1})):S("",!0)]),_:1}),e(g,{cols:"12"},{default:l(()=>[a("div",dl,[(r(!0),I(Z,null,ne(H.value,(t,O)=>(r(),I("div",{key:O,class:"comment"},[a("div",rl,[a("span",ml,c(t.created_at),1)]),a("div",{class:"comment-body",innerHTML:t.comment_with_user},null,8,cl)]))),128))])]),_:1})]),_:1})]),_:1}),e(U,{value:"university-communication"},{default:l(()=>[e(T,null,{default:l(()=>[e(g,{cols:"12",class:"d-flex justify-end"},{default:l(()=>[d.$can("university_communication","application")?(r(),A(_,{key:0,color:"primary",onClick:o[17]||(o[17]=t=>k.value=!0)},{default:l(()=>[u(" Add New Communication ")]),_:1})):S("",!0)]),_:1}),e(g,{cols:"12"},{default:l(()=>[a("div",pl,[(r(!0),I(Z,null,ne(q.value,(t,O)=>(r(),I("div",{key:O,class:"comment"},[a("div",fl,[a("span",vl,c(t.created_at),1)]),a("div",_l,[Vl,u(" "+c(t.subject),1)]),a("div",gl,[a("div",{innerHTML:t.message},null,8,bl)])]))),128))])]),_:1})]),_:1})]),_:1}),d.$can("enable","aco-ao-communication")?(r(),A(U,{key:0,value:"aco-ao-communication"},{default:l(()=>[e(ke,{"application-id":V(v)},null,8,["application-id"])]),_:1})):S("",!0),e(U,{value:"activity-logs"},{default:l(()=>[e(Ae,{"application-id":V(v)},null,8,["application-id"])]),_:1}),e(U,{value:"assign-officer"},{default:l(()=>[e(De,{"application-id":V(v)},null,8,["application-id"])]),_:1}),e(U,{value:"assign-compliance-officer"},{default:l(()=>[e(Ue,{"application-id":V(v)},null,8,["application-id"])]),_:1}),e(U,{value:"aco-co-communication"},{default:l(()=>[e($e,{"application-id":V(v)},null,8,["application-id"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})}}},ga=Oe(yl,[["__scopeId","data-v-e5f01468"]]);export{ga as default};
