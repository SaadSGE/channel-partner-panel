import{_ as G}from"./TablePagination-DZnEBh-t.js";import{_ as le}from"./ShowMore-BtBQ3Dum.js";import{_ as J}from"./AppSelect-HbQSgusO.js";import{_ as ae}from"./AppTextField-CbnfjP5j.js";import{u as X,f as Y}from"./format-DmD9Hoh6.js";import{u as re}from"./applicationList-xjbZ9dsR.js";import"./commonFunction-D94rFR1o.js";import{u as ie}from"./recordStore-CguJ4i9J.js";import{u as ue}from"./user-CgdS--sV.js";import{f as de,g as pe,d as O}from"./helpers-BbIO1H0q.js";import{_ as ce}from"./AppDateTimePicker-D6m9K7mC.js";import{V as x}from"./VCardText-DorCKuQ2.js";import{V as B,a as U}from"./VRow-Bowiu52K.js";import{V as _e}from"./VDivider-7V1xN1RT.js";import{V as Z}from"./VDataTableServer-BvFYm7u8.js";import{V as me}from"./VChip-BiisTgBz.js";import{V as C,a as ge,b as Q,c as ve}from"./VCard-BLy1IeAC.js";import{r as a,w as fe,H as ee,o as c,f as S,e as l,b as o,v as n,x as s,n as I,c as m,d as e,j as ye,k as he,F as z,i as K,a1 as W,a7 as be,z as F}from"./main-CaYBlf2G.js";import ke from"./index-DQsjGTeg.js";import Ue from"./UserBioPanel-Cwu-fWjy.js";import"./VPagination-Bd5cvR5Q.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-D2H1lMMZ.js";import"./VSelect-DBY37Y_U.js";import"./VTextField-CVnNAWWx.js";/* empty css                   */import"./VCounter-CyjC8zNo.js";import"./index-BTkuthYF.js";import"./index-DT0u05fz.js";import"./VField-uZak2RpU.js";import"./easing-CjukEv2V.js";import"./VInput-D2psb41Z.js";import"./forwardRefs-C-GTDzx5.js";import"./VList-Ouc7RLpQ.js";import"./ssrBoot-C5gKPQl-.js";import"./VAvatar-CPnjHhuM.js";import"./VImg-DBWC-qvd.js";import"./dialog-transition-BI8YeWrK.js";import"./VMenu-BqVrXy81.js";import"./VOverlay-CeUiEBY1.js";import"./lazy-ClWo_5bl.js";import"./scopeId-Bkwz8A_X.js";import"./VCheckboxBtn-D_yYJvmL.js";import"./VSelectionControl-aDbLzPdj.js";import"./api-Bja1UkY3.js";import"./index-B3bPRkoL.js";/* empty css              */import"./VDataTable-DiDewQ9N.js";import"./VTable-Rg1CPoPt.js";import"./filter-jh_apkqn.js";import"./VSlideGroup-DZP_R-mU.js";import"./AppCardActions-VL4enk9x.js";import"./AppAutocomplete-DmWQasPv.js";import"./sweetalert2-z6gKu1nJ.js";import"./VSpacer-3dV7V4OH.js";import"./formatters-CDnQs-Fa.js";import"./UserUpgradePlanDialog-Ceu5g_QR.js";import"./ConfirmDialog-BybS4_hj.js";import"./VDialog-WAsERWGL.js";import"./DialogCloseBtn-C0oShWpw.js";import"./UserInfoEditDialog-BVJWxKT_.js";import"./VForm-DfnnKryL.js";import"./VSwitch-Bwc5rSTB.js";const Ae={key:0},we=e("strong",null,"Application ID:",-1),Ve=e("br",null,null,-1),Se=e("strong",null,"Student Name:",-1),xe=e("br",null,null,-1),Le=e("strong",null,"Student Email:",-1),De=e("br",null,null,-1),Ce=e("strong",null,"University:",-1),Ie=e("br",null,null,-1),Pe=e("strong",null,"Intake:",-1),$e={key:1},Te=e("strong",null,"Application ID:",-1),Ne=e("br",null,null,-1),qe=e("strong",null,"Student Email:",-1),Be=e("br",null,null,-1),Ee=e("strong",null,"New Status:",-1),Re=e("br",null,null,-1),je=e("strong",null,"Old Status:",-1),ze=e("br",null,null,-1),Fe=e("strong",null,"Student Email:",-1),He=e("br",null,null,-1),Me=e("strong",null,"University:",-1),Oe=e("br",null,null,-1),Qe=e("strong",null,"Intake:",-1),Ke=e("br",null,null,-1),We={key:2},Ge=e("strong",null,"Application ID:",-1),Je=e("br",null,null,-1),Xe=e("strong",null,"Student Email:",-1),Ye=e("br",null,null,-1),Ze=e("strong",null,"University:",-1),et=e("br",null,null,-1),tt=e("strong",null,"Intake:",-1),ot=e("br",null,null,-1),st=e("strong",null,"Document Name:",-1),nt={key:3},lt=e("strong",null,"Application ID:",-1),at=e("br",null,null,-1),rt=e("strong",null,"Student Email:",-1),it=e("br",null,null,-1),ut=e("strong",null,"University:",-1),dt=e("br",null,null,-1),pt=e("strong",null,"Intake:",-1),ct=e("br",null,null,-1),_t=e("strong",null,"Comment:",-1),mt={key:4},gt=e("strong",null,"Application ID:",-1),vt=e("br",null,null,-1),ft=e("strong",null,"Student Email:",-1),yt=e("br",null,null,-1),ht=e("strong",null,"University:",-1),bt=e("br",null,null,-1),kt=e("strong",null,"Intake:",-1),Ut=e("br",null,null,-1),At=e("strong",null,"Subject:",-1),wt={key:5},Vt=e("strong",null,"University Name:",-1),St=e("br",null,null,-1),xt=e("strong",null,"Course Name:",-1),Lt=e("br",null,null,-1),Dt=e("strong",null,"Intake:",-1),Ct={key:6},It=e("strong",null,"Error:",-1),Pt=e("br",null,null,-1),$t=e("strong",null,"University Name:",-1),Tt=e("br",null,null,-1),Nt=e("strong",null,"Course Name:",-1),qt=e("br",null,null,-1),Bt=e("strong",null,"Intake:",-1),Et={key:7},Rt={__name:"UserActivityLog",props:{userId:{type:String,required:!0}},setup(H){const h=H,g=X(),P=a([]),L=a(!1),v=a(0),_=a(1),f=a(10),$=a(""),A=a(null),b=a(null),w=a(null),D=[{title:"Login",value:"login"},{title:"Logout",value:"logout"},{title:"Application Submit",value:"application_submit"},{title:"Application Update",value:"application_update"},{title:"Document Upload",value:"document_upload"}],E=[{title:"Date",key:"created_at",sortable:!0},{title:"Activity Type",key:"description",sortable:!0},{title:"Details",key:"details",sortable:!1},{title:"IP Address",key:"ip_address",sortable:!1}],V=async()=>{L.value=!0;try{g.setPage(_.value),g.setPerPage(f.value),g.setActivityType(A.value),g.setSearchQuery($.value),g.setDateFrom(b.value),g.setDateTo(w.value);const u=await g.fetchUserActivityLogs(h.userId);P.value=u.data.data.map(i=>({...i,created_at:Y(new Date(i.created_at),"yyyy-MM-dd HH:mm:ss"),ip_address:i.properties.ip||"N/A",details:T(i)})),v.value=u.data.total}catch(u){console.error("Error fetching activity logs:",u)}finally{L.value=!1}},T=u=>{switch(u.description){case"login":return"User logged in";case"logout":return"User logged out";case"profile_update":return"Updated profile information";case"password_change":return"Changed password";case"application_submit":return`Submitted application #${u.properties.application_id}`;case"application_update":return`Updated application #${u.properties.application_id}`;case"document_upload":return`Uploaded document: ${u.properties.document_name||"Unknown"}`;case"comment_add":return`Added comment to application #${u.properties.application_id||"Unknown"}`;default:return u.description||"Performed an action"}},R=u=>{switch(u){case"login":return"success";case"logout":return"warning";case"application_submit":return"primary";case"application_status_update":return"info";case"document_upload":return"secondary";case"comment_added":return"success";case"university_communication_added":return"info";case"course_request_submitted":return"primary";case"course_request_failed":return"error";case"profile_update":return"secondary";case"password_change":return"warning";default:return"default"}},N=u=>{_.value=u.page,f.value=u.itemsPerPage,u.sortBy&&u.sortBy.length>0&&g.setSorting(u.sortBy[0].key,u.sortBy[0].order),V()};return fe([$,A,b,w],()=>{_.value=1,V()}),ee(()=>{V()}),(u,i)=>{const y=J,k=ce,j=G;return c(),S(C,{title:"User Activity Log",class:"mt-5"},{default:l(()=>[o(x,null,{default:l(()=>[o(B,{class:"d-flex justify-end align-center"},{default:l(()=>[o(U,{cols:"12",sm:"6",md:"3"},{default:l(()=>[o(y,{modelValue:A.value,"onUpdate:modelValue":i[0]||(i[0]=t=>A.value=t),items:D,placeholder:"Select Activity Type",clearable:""},null,8,["modelValue"])]),_:1}),o(U,{cols:"12",sm:"6",md:"3"},{default:l(()=>[o(k,{modelValue:b.value,"onUpdate:modelValue":i[1]||(i[1]=t=>b.value=t),placeholder:"Select From Date"},null,8,["modelValue"])]),_:1}),o(U,{cols:"12",sm:"6",md:"3"},{default:l(()=>[o(k,{modelValue:w.value,"onUpdate:modelValue":i[2]||(i[2]=t=>w.value=t),placeholder:"Select To Date"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(_e),o(x,null,{default:l(()=>[o(B,{class:"d-flex justify-end align-center"},{default:l(()=>[o(U,{cols:"auto"},{default:l(()=>[o(y,{modelValue:f.value,"onUpdate:modelValue":[i[3]||(i[3]=t=>f.value=t),i[4]||(i[4]=t=>f.value=parseInt(t,10))],items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],label:"Items per page",style:{"inline-size":"8rem"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(Z,{"items-per-page":f.value,"onUpdate:itemsPerPage":i[6]||(i[6]=t=>f.value=t),page:_.value,"onUpdate:page":i[7]||(i[7]=t=>_.value=t),items:P.value,"items-length":v.value,headers:E,loading:L.value,class:"text-no-wrap","onUpdate:options":N},{"item.description":l(({item:t})=>[o(me,{color:R(t.description),size:"small"},{default:l(()=>[n(s(I(de)(t.description)),1)]),_:2},1032,["color"])]),"item.details":l(({item:t})=>[t.description==="application_submit"?(c(),m("div",Ae,[we,n(" "+s(t.properties.application_id),1),Ve,Se,n(" "+s(t.properties.student_name),1),xe,Le,n(" "+s(t.properties.student_email),1),De,Ce,n(" "+s(t.properties.university_name),1),Ie,Pe,n(" "+s(t.properties.intake_name),1)])):t.description==="application_status_update"?(c(),m("div",$e,[Te,n(" "+s(t.properties.application_id),1),Ne,qe,n(" "+s(t.properties.student_email),1),Be,Ee,n(" "+s(t.properties.new_status),1),Re,je,n(" "+s(t.properties.old_status),1),ze,Fe,n(" "+s(t.properties.student_email),1),He,Me,n(" "+s(t.properties.university_name),1),Oe,Qe,n(" "+s(t.properties.intake_name),1),Ke])):t.description==="document_upload"?(c(),m("div",We,[Ge,n(" "+s(t.properties.application_id),1),Je,Xe,n(" "+s(t.properties.student_email),1),Ye,Ze,n(" "+s(t.properties.university_name),1),et,tt,n(" "+s(t.properties.intake_name),1),ot,st,n(" "+s(t.properties.document_name),1)])):t.description==="comment_added"?(c(),m("div",nt,[lt,n(" "+s(t.properties.application_id),1),at,rt,n(" "+s(t.properties.student_email),1),it,ut,n(" "+s(t.properties.university_name),1),dt,pt,n(" "+s(t.properties.intake_name),1),ct,_t,n(" "+s(t.properties.comment),1)])):t.description==="university_communication_added"?(c(),m("div",mt,[gt,n(" "+s(t.properties.application_id),1),vt,ft,n(" "+s(t.properties.student_email),1),yt,ht,n(" "+s(t.properties.university_name),1),bt,kt,n(" "+s(t.properties.intake_name),1),Ut,At,n(" "+s(t.properties.subject),1)])):t.description==="course_request_submitted"?(c(),m("div",wt,[Vt,n(" "+s(t.properties.university_name),1),St,xt,n(" "+s(t.properties.course_name),1),Lt,Dt,n(" "+s(t.properties.intake),1)])):t.description==="course_request_failed"?(c(),m("div",Ct,[It,n(" "+s(t.properties.error),1),Pt,$t,n(" "+s(t.properties.university_name),1),Tt,Nt,n(" "+s(t.properties.course_name),1),qt,Bt,n(" "+s(t.properties.intake),1)])):(c(),m("div",Et,s(t.details),1))]),bottom:l(()=>[o(j,{page:_.value,"onUpdate:page":i[5]||(i[5]=t=>_.value=t),"items-per-page":f.value,"total-items":v.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","items","items-length","loading"])]),_:1})}}},jt={class:"d-flex align-center justify-space-between gap-x-2"},zt={class:"text-h4 text-center"},Ft=["href"],Ht={class:"d-flex justify-space-between flex-wrap gap-6"},Mt={class:"d-flex flex-row gap-4 align-center flex-wrap"},os={__name:"[id]",setup(H){const h=ye();a(null),he();const g=ie(),P=a(pe()==="admin");a();const L=ue();re();const v=a([]),_=a(""),f=a(!1),$=X(),A=a([]),b=a(!1),w=a(0),D=a({page:1,itemsPerPage:10,sortBy:[{key:"created_at",order:"desc"}]});ee(async()=>{v.value=await L.fetchUser(h.params.id),N.value=v.value.documents||[],await V(),await t()});const E=d=>{const r=document.createElement("a");r.href=d,r.target="_blank",r.download="test",document.body.appendChild(r),r.click(),document.body.removeChild(r)},V=async(d=1)=>{const r=await g.fetchRecord(d,_.value,h.params.id);u.value=r.data,i.value=r.total},T=d=>d.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase()),R=[{title:"Country",key:"country.name"},{title:"Intake",key:"intake.name"},{title:"University",key:"university.name"},{title:"Course Type",key:"course.type"},{title:"Course Name",key:"course.name"},{title:"Tution Fee",key:"tuition_fee"},{title:"Course Duration",key:"course_duration"},{title:"Academic Requirement",key:"academic_requirement"},{title:"English Requirement",key:"english_requirement"},{title:"Actions",key:"actions",sortable:!1}],N=a([]);a(""),a(""),a(""),a("");const u=a(),i=a(),y=a(10),k=a(1),j=d=>{V(d.page)};a([]),a(0),a(),a();const t=async()=>{b.value=!0;try{const d=await $.fetchUserActivityLogs(h.params.id,D.value.page,D.value.itemsPerPage,D.value.sortBy[0]);A.value=d.data.data.map(r=>({...r,created_at:Y(new Date(r.created_at),"yyyy-MM-dd HH:mm:ss"),ip_address:r.properties.ip||"N/A",details:te(r)})),w.value=d.data.total}catch(d){console.error("Error fetching activity logs:",d)}finally{b.value=!1}},te=d=>{switch(d.description){case"login":return"User logged in";case"logout":return"User logged out";case"profile_update":return"Updated profile information";case"password_change":return"Changed password";case"application_submit":return`Submitted application #${d.properties.application_id}`;case"application_update":return`Updated application #${d.properties.application_id}`;case"document_upload":return`Uploaded document: ${d.properties.document_name||"Unknown"}`;case"comment_add":return`Added comment to application #${d.properties.application_id||"Unknown"}`;default:return d.description||"Performed an action"}};return(d,r)=>{const oe=ae,se=J,M=le,ne=G;return c(),m(z,null,[o(B,null,{default:l(()=>[o(U,{cols:"12",md:"5",lg:"4"},{default:l(()=>[o(Ue,{"user-data":v.value},null,8,["user-data"])]),_:1}),o(U,{cols:"12",md:"4",sm:"6",lg:"8"},{default:l(()=>[o(B,null,{default:l(()=>[(c(!0),m(z,null,K(v.value.dashboard,(p,q)=>(c(),S(U,{cols:"12",md:"5",lg:"4",key:q},{default:l(()=>[o(C,null,{default:l(()=>[o(ge,{class:"pb-3"},{default:l(()=>[o(Q,null,{default:l(()=>[n(s(T(q)),1)]),_:2},1024),o(ve,null,{default:l(()=>[n("Last Week")]),_:1})]),_:2},1024),o(x,null,{default:l(()=>[e("div",jt,[e("h4",zt,s(p),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),I(O)(v.value.role,"channel partner")?(c(),S(C,{key:0,class:"mt-5"},{default:l(()=>[o(ke,{userId:I(h).params.id},null,8,["userId"]),o(Q,null,{default:l(()=>[n("Documents")]),_:1}),o(x,null,{default:l(()=>[(c(!0),m(z,null,K(N.value,(p,q)=>(c(),S(C,{key:q,class:"mb-2"},{default:l(()=>[o(x,{class:"d-flex justify-space-between align-center"},{default:l(()=>[e("div",null,[o(W,{size:"26",color:"red",icon:"tabler-file-type-doc"}),e("a",{href:p.document_path,target:"_blank"},s(T(p.document_type)),9,Ft)]),o(be,{icon:"",onClick:Ot=>E(p.document_path)},{default:l(()=>[o(W,{size:"24",icon:"tabler-eye"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):F("",!0),I(O)(v.value.role,"editor")?(c(),S(C,{key:1,title:"Course Details",class:"mt-2"},{default:l(()=>[o(x,null,{default:l(()=>[e("div",Ht,[e("div",null,[o(oe,{modelValue:_.value,"onUpdate:modelValue":r[0]||(r[0]=p=>_.value=p),style:{"max-inline-size":"200px","min-inline-size":"200px"},placeholder:"Search Record"},null,8,["modelValue"])]),e("div",Mt,[o(se,{modelValue:y.value,"onUpdate:modelValue":r[1]||(r[1]=p=>y.value=p),items:[10,25,50,100],style:{"inline-size":"6.25rem"}},null,8,["modelValue"])])])]),_:1}),o(Z,{"items-per-page":y.value,"onUpdate:itemsPerPage":r[3]||(r[3]=p=>y.value=p),page:k.value,"onUpdate:page":r[4]||(r[4]=p=>k.value=p),loading:f.value,"items-length":i.value,headers:R,items:u.value,"item-value":"total",class:"text-no-wrap text-sm rounded-0","onUpdate:options":j},{"item.academic_requirement":l(({item:p})=>[o(M,{text:p.academic_requirement,lines:3},null,8,["text"])]),"item.english_requirement":l(({item:p})=>[o(M,{text:p.english_requirement,lines:3},null,8,["text"])]),bottom:l(()=>[o(ne,{page:k.value,"onUpdate:page":r[2]||(r[2]=p=>k.value=p),"items-per-page":y.value,"total-items":i.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","loading","items-length","items"])]),_:1})):F("",!0),P.value?(c(),S(Rt,{key:2,userId:I(h).params.id},null,8,["userId"])):F("",!0)],64)}}};export{os as default};
