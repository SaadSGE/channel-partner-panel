import{ah as g,ag as l}from"./main-BFCxogYT.js";import{a as w,w as R}from"./index-BYrzgnBV.js";class S extends Error{constructor(s,n){super(s,n),this.name="FetchError",n!=null&&n.cause&&!this.cause&&(this.cause=n.cause)}}function _(o){var c,i,e,y,h;const s=((c=o.error)==null?void 0:c.message)||((i=o.error)==null?void 0:i.toString())||"",n=((e=o.request)==null?void 0:e.method)||((y=o.options)==null?void 0:y.method)||"GET",a=((h=o.request)==null?void 0:h.url)||String(o.request)||"/",f=`[${n}] ${JSON.stringify(a)}`,p=o.response?`${o.response.status} ${o.response.statusText}`:"<no response>",u=`${f}: ${p}${s?` ${s}`:""}`,r=new S(u,o.error?{cause:o.error}:void 0);for(const t of["request","options","response"])Object.defineProperty(r,t,{get(){return o[t]}});for(const[t,d]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(r,t,{get(){return o.response&&o.response[d]}});return r}const q=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function b(o="GET"){return q.has(o.toUpperCase())}function A(o){if(o===void 0)return!1;const s=typeof o;return s==="string"||s==="number"||s==="boolean"||s===null?!0:s!=="object"?!1:Array.isArray(o)?!0:o.buffer?!1:o.constructor&&o.constructor.name==="Object"||typeof o.toJSON=="function"}const P=new Set(["image/svg","application/xml","application/xhtml","application/html"]),j=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function V(o=""){if(!o)return"json";const s=o.split(";").shift()||"";return j.test(s)?"json":P.has(s)||s.startsWith("text/")?"text":"blob"}function $(o,s,n=globalThis.Headers){const a={...s,...o};if(s!=null&&s.params&&(o!=null&&o.params)&&(a.params={...s==null?void 0:s.params,...o==null?void 0:o.params}),s!=null&&s.query&&(o!=null&&o.query)&&(a.query={...s==null?void 0:s.query,...o==null?void 0:o.query}),s!=null&&s.headers&&(o!=null&&o.headers)){a.headers=new n((s==null?void 0:s.headers)||{});for(const[f,p]of new n((o==null?void 0:o.headers)||{}))a.headers.set(f,p)}return a}const C=new Set([408,409,425,429,500,502,503,504]),O=new Set([101,204,205,304]);function T(o={}){const{fetch:s=globalThis.fetch,Headers:n=globalThis.Headers,AbortController:a=globalThis.AbortController}=o;async function f(r){const c=r.error&&r.error.name==="AbortError"&&!r.options.timeout||!1;if(r.options.retry!==!1&&!c){let e;typeof r.options.retry=="number"?e=r.options.retry:e=b(r.options.method)?0:1;const y=r.response&&r.response.status||500;if(e>0&&(Array.isArray(r.options.retryStatusCodes)?r.options.retryStatusCodes.includes(y):C.has(y))){const h=r.options.retryDelay||0;return h>0&&await new Promise(t=>setTimeout(t,h)),p(r.request,{...r.options,retry:e-1,timeout:r.options.timeout})}}const i=_(r);throw Error.captureStackTrace&&Error.captureStackTrace(i,p),i}const p=async function(c,i={}){var h;const e={request:c,options:$(i,o.defaults,n),response:void 0,error:void 0};if(e.options.method=(h=e.options.method)==null?void 0:h.toUpperCase(),e.options.onRequest&&await e.options.onRequest(e),typeof e.request=="string"&&(e.options.baseURL&&(e.request=w(e.request,e.options.baseURL)),(e.options.query||e.options.params)&&(e.request=R(e.request,{...e.options.params,...e.options.query}))),e.options.body&&b(e.options.method)&&(A(e.options.body)?(e.options.body=typeof e.options.body=="string"?e.options.body:JSON.stringify(e.options.body),e.options.headers=new n(e.options.headers||{}),e.options.headers.has("content-type")||e.options.headers.set("content-type","application/json"),e.options.headers.has("accept")||e.options.headers.set("accept","application/json")):("pipeTo"in e.options.body&&typeof e.options.body.pipeTo=="function"||typeof e.options.body.pipe=="function")&&("duplex"in e.options||(e.options.duplex="half"))),!e.options.signal&&e.options.timeout){const t=new a;setTimeout(()=>t.abort(),e.options.timeout),e.options.signal=t.signal}try{e.response=await s(e.request,e.options)}catch(t){return e.error=t,e.options.onRequestError&&await e.options.onRequestError(e),await f(e)}if(e.response.body&&!O.has(e.response.status)&&e.options.method!=="HEAD"){const t=(e.options.parseResponse?"json":e.options.responseType)||V(e.response.headers.get("content-type")||"");switch(t){case"json":{const d=await e.response.text(),m=e.options.parseResponse||g;e.response._data=m(d);break}case"stream":{e.response._data=e.response.body;break}default:e.response._data=await e.response[t]()}}return e.options.onResponse&&await e.options.onResponse(e),!e.options.ignoreResponseError&&e.response.status>=400&&e.response.status<600?(e.options.onResponseError&&await e.options.onResponseError(e),await f(e)):e.response},u=async function(c,i){return(await p(c,i))._data};return u.raw=p,u.native=(...r)=>s(...r),u.create=(r={})=>T({...o,defaults:{...o.defaults,...r}}),u}const E=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),B=E.fetch||(()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!"))),I=E.Headers,k=E.AbortController,L=T({fetch:B,Headers:I,AbortController:k});var H={VITE_APP_NAME:"Shabujglobal.org",VITE_REVERB_APP_KEY:"d1eop90n3fpgmkutltzq",VITE_REVERB_HOST:"localhost",VITE_REVERB_PORT:"8080",VITE_REVERB_SCHEME:"http",VITE_WEBSITE:"org",VITE_APP_URL:"http://127.0.0.1:8000",VITE_TOKEN:"822|SQ9F2uSCR6SqwVH9pp1LOBhZgXudhgQsiMTi5GLI5c99775b",VITE_PYTHON_API_BASE_URL:"https://service.shabujglobal.org",BASE_URL:"/build/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const D=L.create({baseURL:H.VITE_API_BASE_URL||"/api",async onRequest({options:o}){const s=l("accessToken").value||"822|SQ9F2uSCR6SqwVH9pp1LOBhZgXudhgQsiMTi5GLI5c99775b";o.headers={...o.headers,Accept:"application/json"},s&&(o.headers={...o.headers,Authorization:`Bearer ${s}`})},async onResponseError({response:o}){o.status===401&&(l("accessToken").value=null,l("userData").value=null,window.location.href="/login")}});export{D as $};
