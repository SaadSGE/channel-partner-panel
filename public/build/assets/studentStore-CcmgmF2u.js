import{aK as p,aL as c}from"./main-Z3go8Xzc.js";const g=t=>t?new Date(t).toISOString().split("T")[0]:null,m=p({id:"student-store",state:()=>({errors:[],successMessage:"",students:[],studentInfo:{generalInfo:{},educationalHistory:[],employmentHistory:[],englishProficiency:[],interestedUniversity:[],documentPaths:[]}}),actions:{async storeStudent(t){var n,r,a,l;try{const o={general_info:{student_first_name:t.generalInfo.first_name,student_last_name:t.generalInfo.last_name,student_email:t.generalInfo.email,student_whatsapp_number:t.generalInfo.mobile,date_of_birth:g(t.generalInfo.date_of_birth),gender:t.generalInfo.gender,student_passport_no:t.generalInfo.passport_number,student_address:t.generalInfo.address,student_city:t.generalInfo.city,student_country:t.generalInfo.country,student_region_state:t.generalInfo.state,visa_refusal:t.generalInfo.visa_refusal}},i={interested_university:(n=t.universityEntry)!=null&&n.length?t.universityEntry.map(e=>({country_id:e.country_id||null,intake_id:e.intake_id||null,university_id:e.university_id||null,course_id:e.course_id||null})).filter(e=>e.country_id||e.intake_id||e.university_id||e.course_id):[]},u={educational_history:(r=t.educationalHistory)!=null&&r.length?t.educationalHistory.map(e=>({degree_name:e.degree||null,institution_name:e.institution||null,passing_year:e.passing_year||null,result:e.result||null})).filter(e=>e.degree_name||e.institution_name||e.passing_year||e.result):[]},d={english_proficiency:(a=t.englishProficiency)!=null&&a.length?t.englishProficiency.map(e=>({proficiency_title:e.proficiencyTitle||null,overall_score:e.overallScore||null,reading:e.reading||null,writing:e.writing||null,speaking:e.speaking||null,listening:e.listening||null})).filter(e=>e.proficiency_title||e.overall_score||e.reading||e.writing||e.speaking||e.listening):[]},s={employment_history:(l=t.employmentHistory)!=null&&l.length?t.employmentHistory.map(e=>({company_name:e.company_name||null,designation:e.designation||null,year:e.year||null})).filter(e=>e.company_name||e.designation||e.year):[]},y={document_paths:t.documentPaths.map(e=>({path:e}))},_=await c("/students",{method:"POST",body:JSON.stringify({...o,...i,...u,...d,...s,...y})});return this.successMessage="Student created successfully",_.data}catch(o){throw console.error("Error storing student:",o),this.errors=o.response?o.response.data.errors:["An unexpected error occurred"],o}},async getStudentList(t=1,n=10,r="",a="",l="",o={}){try{const i=await c("/students",{method:"GET",params:{page:t,perPage:n,searchQuery:r,sortBy:a,orderBy:l,...o}});return this.students=i.data,i}catch(i){throw console.error("Error fetching students:",i),this.errors=i.response?i.response.data.errors:["An unexpected error occurred"],i}},async getStudentDetails(t){try{const n=await c(`/students/${t}`,{method:"GET"}),r=n.data;return this.studentInfo={generalInfo:r.generalInfo||{},educationalHistory:r.educationalHistory||[],employmentHistory:r.employmentHistory||[],englishProficiency:r.englishProficiency||[],interestedUniversity:r.interestedUniversity||[],documentPaths:r.documentPaths||[]},n.data}catch(n){throw console.error("Error fetching student details:",n),this.errors=n.response?n.response.data.errors:["An unexpected error occurred"],n}},async updateStudent(t,n){try{const r={general_info:{first_name:n.generalInfo.first_name,last_name:n.generalInfo.last_name,email:n.generalInfo.email,mobile:n.generalInfo.mobile,date_of_birth:g(n.generalInfo.date_of_birth),gender:n.generalInfo.gender,passport_no:n.generalInfo.passport_number,address:n.generalInfo.address,city:n.generalInfo.city,country:n.generalInfo.country,visa_refusal:n.generalInfo.visaRefusal}},a={interested_university:n.universityEntry.map(s=>({country_id:s.country_id,intake_id:s.intake_id,course_type:s.course_type,university_id:s.university_id,course_id:s.course_id}))},l={educational_history:n.educationalHistory.map(s=>({degree_name:s.degree,institution_name:s.institution,passing_year:s.passingYear,result:s.result}))},o={english_proficiency:n.englishProficiency.map(s=>({proficiency_title:s.proficiencyTitle,overall_score:s.overallScore,reading:s.reading,writing:s.writing,speaking:s.speaking,listening:s.listening}))},i={employment_history:n.employmentHistory.map(s=>({company_name:s.company_name,designation:s.designation,year:s.year}))},u={document_paths:n.documentPaths||[]},d=await c(`/student/${t}`,{method:"PUT",body:JSON.stringify({...r,...a,...l,...o,...i,...u})});return this.successMessage="Student updated successfully",d.data}catch(r){throw console.error("Error updating student:",r),this.errors=r.response?r.response.data.errors:["An unexpected error occurred"],r}},async deleteStudent(t){try{await c(`/student/${t}`,{method:"DELETE"}),this.successMessage="Student deleted successfully"}catch(n){throw console.error("Error deleting student:",n),this.errors=n.response?n.response.data.errors:["An unexpected error occurred"],n}},clearErrors(){this.errors=[]},clearSuccessMessage(){this.successMessage=""}}});export{m as u};
